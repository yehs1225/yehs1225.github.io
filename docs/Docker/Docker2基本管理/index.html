<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.15">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Yeh&#39;s blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Yeh&#39;s blog Atom Feed"><title data-react-helmet="true">Docker[2]基本管理 | Yeh&#x27;s blog</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://your-docusaurus-test-site.com/docs/Docker/Docker2基本管理"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Docker[2]基本管理 | Yeh&#x27;s blog"><meta data-react-helmet="true" name="description" content="- 啟動Docker$sudo systemctl start docker"><meta data-react-helmet="true" property="og:description" content="- 啟動Docker$sudo systemctl start docker"><link data-react-helmet="true" rel="icon" href="/img/favicon.png"><link data-react-helmet="true" rel="canonical" href="https://your-docusaurus-test-site.com/docs/Docker/Docker2基本管理"><link data-react-helmet="true" rel="alternate" href="https://your-docusaurus-test-site.com/docs/Docker/Docker2基本管理" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://your-docusaurus-test-site.com/docs/Docker/Docker2基本管理" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.f2b17ad4.css">
<link rel="preload" href="/assets/js/runtime~main.5ff5b40d.js" as="script">
<link rel="preload" href="/assets/js/main.0b6d2e73.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/favicon.png" alt="My Site Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/favicon.png" alt="My Site Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">My Site</b></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/intro">Notes</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/yehs1225" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_Pssr toggle_TdHA toggleDisabled_jDku"><div class="toggleTrack_SSoT" role="button" tabindex="-1"><div class="toggleTrackCheck_XobZ"><span class="toggleIcon_eZtF">🌜</span></div><div class="toggleTrackX_YkSC"><span class="toggleIcon_eZtF">🌞</span></div><div class="toggleTrackThumb_uRm4"></div></div><input type="checkbox" class="toggleScreenReader_JnkT" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_CW9Y"><nav class="menu thin-scrollbar menu_SkdO"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">Notes Intro</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/Algorithm/Algorithm[1]">Algorithm</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/BasicKnowlege/CSS-RWD切版練習">BasicKnowlege</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/DataStructures/Graph">DataStructures</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/Django/[DJ]Deploy">Django</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_VCh3" aria-current="page" href="/docs/Docker/Docker1基本介紹">Docker</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Docker/Docker1基本介紹">Docker[1]基本介紹</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/Docker/Docker2基本管理">Docker[2]基本管理</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/JavaScript/JavaScript-this">JavaScript</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/Python/Python_Class">Python</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/Reactjs/React_ES6">Reactjs</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/Tools/Command-Line-and-Vim">Tools</a></div></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Docker<!-- -->[2]<!-- -->基本管理</h1><ul><li>啟動Docker<code>$sudo systemctl start docker </code></li><li>查看Docker狀態`<code>$sudo systemctl status docker</code></li><li>關閉Docker<code>$sudo systemstl stop docker</code></li></ul><p>（<code>systemctl</code> 指令用來管理 Systemd 的系統服務。）</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="拒絕存取permissiondenied">拒絕存取（permission　denied）<a class="hash-link" href="#拒絕存取permissiondenied" title="Direct link to heading">​</a></h2><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">Got permission denied </span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> trying to connect to the Docker daemon socket at unix:///var/run/docker.sock: Get http://%2Fvar%2Frun%2Fdocker.sock/v1.24/images/search?limit</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">25</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token assign-left variable" style="color:#36acaa">term</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">mysql: dial unix /var/run/docker.sock: connect: permission denied</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>因為目前使用者root不具存取權，因此有兩種解決辦法</p><ol><li>每次<code>$docker</code>前都加上 <code>sudo</code></li><li>將root加進管理群<ol><li><code>$sudo group docker</code></li><li><code>$sudo usermod -aG docker $USER</code></li><li><code>$newgrp docker</code></li></ol></li></ol><h2 class="anchor anchorWithStickyNavbar_mojV" id="映像檔">映像檔<a class="hash-link" href="#映像檔" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_mojV" id="尋找">尋找<a class="hash-link" href="#尋找" title="Direct link to heading">​</a></h3><p><code>$docker search &lt;keyword&gt;</code> ，加上 <code>-s</code> 或<code>-start</code>可過濾評價較高的。</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="下載">下載<a class="hash-link" href="#下載" title="Direct link to heading">​</a></h3><p><code>$docker pull &lt;name:tag&gt;</code> ，<code>tag</code>是選擇性的，可選擇倉庫中多版本的其一，若未指定就是最新的。</p><p>tag對於管理有極大的幫助!好讓我們區分不同版本。</p><p>大部分映像檔都是分層儲存的，例如某一映像檔由4層組成，而其中幾層本地倉庫因為之前下載其他套件已經有儲存了，Docker就可以不用再下載一次。</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="列表">列表<a class="hash-link" href="#列表" title="Direct link to heading">​</a></h3><p><code>$docker images</code></p><h3 class="anchor anchorWithStickyNavbar_mojV" id="刪除">刪除<a class="hash-link" href="#刪除" title="Direct link to heading">​</a></h3><p><code>$docker rmi image</code>，若要刪除多個用空格隔開。</p><p>若有其他容器依賴該映像檔，會出現錯誤提醒，建議先刪除該容器，再刪映像檔。不建議加<code>-f</code>來強制刪除。</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="查看">查看<a class="hash-link" href="#查看" title="Direct link to heading">​</a></h3><p><code>$docker inspect image</code></p><h3 class="anchor anchorWithStickyNavbar_mojV" id="建置">建置<a class="hash-link" href="#建置" title="Direct link to heading">​</a></h3><ol><li><p><code>$docker build</code> ，從無到有生出來!!</p></li><li><p><code>$docker commit</code>，在現有的映像檔中加入功能。</p><ol><li><p>啟動一個ubuntu容器</p><p><code>$docker run -i -t ubuntu/bin/bash</code></p><ul><li><code>-i</code> 採對話模式</li><li><code>-t</code> 為目前使用者分配一個虛擬終端</li><li><code>/bin/bash</code> 要執行的指令</li></ul><p>成功啟動容器後，terminal中會改變</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token variable" style="color:#36acaa">$User</span><span class="token plain">@</span><span class="token variable" style="color:#36acaa">$User</span><span class="token plain">-VirtualBox:~</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@640a645aac6c:/</span><span class="token comment" style="color:#999988;font-style:italic">#</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li>root為目前容器的使用者</li><li>640a645aac6c是容器ID</li><li>#代表superuser</li></ul></li><li><p>更新apt</p><p><code>$apt-get -y update</code></p></li><li><p>安裝Apache2</p><p><code>$apt-get install -y apache2</code></p></li><li><p>退出</p><p><code>$exit</code></p></li><li><p>查看目前所有容器狀態</p><p><code>$docker ps -a</code></p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">CONTAINER ID   IMAGE         COMMAND       CREATED          STATUS                      PORTS     NAMES</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">640a645aac6c   ubuntu        </span><span class="token string" style="color:#e3116c">&quot;/bin/bash&quot;</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">12</span><span class="token plain"> minutes ago   Exited </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">26</span><span class="token plain"> seconds ago             jovial_shaw</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">5c498a3dd677   hello-world   </span><span class="token string" style="color:#e3116c">&quot;/hello&quot;</span><span class="token plain">      </span><span class="token number" style="color:#36acaa">23</span><span class="token plain"> hours ago     Exited </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">23</span><span class="token plain"> hours ago               angry_bardeen</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div></li><li><p>commit 剛才的動作（會存為新的容器）</p><p><code>$ docker commit &lt;CONTAINER ID&gt; </code> </p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">yehs1225@yehs1225-VirtualBox:~$ </span><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> commit 640a645aac6c demo/webserver</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sha256:a83d1ebcfbe03ecb71141cdf59fe00b60ac3fd5663ae89cfd64c9afea6516f92</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div></li><li><p>再檢查是否完成</p><p><code>$ docker images</code></p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">yehs1225@yehs1225-VirtualBox:~$ docker images</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">REPOSITORY       TAG       IMAGE ID       CREATED         SIZE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">demo/webserver   latest    a83d1ebcfbe0   8 seconds ago   107MB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu           latest    2b4cba85892a   13 days ago     72.8MB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hello-world      latest    feb5d9fea6a5   5 months ago    13.3kB</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div></li></ol></li></ol><h3 class="anchor anchorWithStickyNavbar_mojV" id="標籤">標籤<a class="hash-link" href="#標籤" title="Direct link to heading">​</a></h3><p>目前狀態</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">yehs1225@yehs1225-VirtualBox:~$ </span><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ps</span><span class="token plain"> -a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CONTAINER ID   IMAGE         COMMAND       CREATED          STATUS                      PORTS     NAMES</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">640a645aac6c   ubuntu        </span><span class="token string" style="color:#e3116c">&quot;/bin/bash&quot;</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">12</span><span class="token plain"> minutes ago   Exited </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">26</span><span class="token plain"> seconds ago             jovial_shaw</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">5c498a3dd677   hello-world   </span><span class="token string" style="color:#e3116c">&quot;/hello&quot;</span><span class="token plain">      </span><span class="token number" style="color:#36acaa">23</span><span class="token plain"> hours ago     Exited </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">23</span><span class="token plain"> hours ago               angry_bardeen</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li><p>將來源標示為目標映像檔</p><p><code>$docker tag source_image:tag target_image:tag</code></p><p>例如 <code>$docker tag hello-world local/hello-world</code> 將名為hello-world的映像檔標示為local倉庫內的hello-world</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">yehs1225@yehs1225-VirtualBox:~$ </span><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> images</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">REPOSITORY          TAG       IMAGE ID       CREATED          SIZE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">demo/webserver      latest    a83d1ebcfbe0   </span><span class="token number" style="color:#36acaa">14</span><span class="token plain"> minutes ago   107MB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu              latest    2b4cba85892a   </span><span class="token number" style="color:#36acaa">13</span><span class="token plain"> days ago      </span><span class="token number" style="color:#36acaa">72</span><span class="token plain">.8MB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hello-world         latest    feb5d9fea6a5   </span><span class="token number" style="color:#36acaa">5</span><span class="token plain"> months ago     </span><span class="token number" style="color:#36acaa">13</span><span class="token plain">.3kB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">local/hello-world   latest    feb5d9fea6a5   </span><span class="token number" style="color:#36acaa">5</span><span class="token plain"> months ago     </span><span class="token number" style="color:#36acaa">13</span><span class="token plain">.3kB</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div></li><li><p>修改</p><p><code>$docker tag hello-world local/hello-world:v2</code></p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">yehs1225@yehs1225-VirtualBox:~$ </span><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> images</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">REPOSITORY          TAG       IMAGE ID       CREATED          SIZE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">demo/webserver      latest    a83d1ebcfbe0   </span><span class="token number" style="color:#36acaa">14</span><span class="token plain"> minutes ago   107MB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu              latest    2b4cba85892a   </span><span class="token number" style="color:#36acaa">13</span><span class="token plain"> days ago      </span><span class="token number" style="color:#36acaa">72</span><span class="token plain">.8MB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hello-world         latest    feb5d9fea6a5   </span><span class="token number" style="color:#36acaa">5</span><span class="token plain"> months ago     </span><span class="token number" style="color:#36acaa">13</span><span class="token plain">.3kB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">local/hello-world   latest    feb5d9fea6a5   </span><span class="token number" style="color:#36acaa">5</span><span class="token plain"> months ago     </span><span class="token number" style="color:#36acaa">13</span><span class="token plain">.3kB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">local/hello-world   v2        feb5d9fea6a5   </span><span class="token number" style="color:#36acaa">5</span><span class="token plain"> months ago     </span><span class="token number" style="color:#36acaa">13</span><span class="token plain">.3kB</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div></li><li><p>參考其他映像檔ID</p><p><code>$docker tag feb5d9fea6a5 local/hello-world:v3</code></p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">yehs1225@yehs1225-VirtualBox:~$ </span><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> images</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">REPOSITORY          TAG       IMAGE ID       CREATED          SIZE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">demo/webserver      latest    a83d1ebcfbe0   </span><span class="token number" style="color:#36acaa">17</span><span class="token plain"> minutes ago   107MB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu              latest    2b4cba85892a   </span><span class="token number" style="color:#36acaa">13</span><span class="token plain"> days ago      </span><span class="token number" style="color:#36acaa">72</span><span class="token plain">.8MB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hello-world         latest    feb5d9fea6a5   </span><span class="token number" style="color:#36acaa">5</span><span class="token plain"> months ago     </span><span class="token number" style="color:#36acaa">13</span><span class="token plain">.3kB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">local/hello-world   latest    feb5d9fea6a5   </span><span class="token number" style="color:#36acaa">5</span><span class="token plain"> months ago     </span><span class="token number" style="color:#36acaa">13</span><span class="token plain">.3kB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">local/hello-world   v2        feb5d9fea6a5   </span><span class="token number" style="color:#36acaa">5</span><span class="token plain"> months ago     </span><span class="token number" style="color:#36acaa">13</span><span class="token plain">.3kB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">local/hello-world   v3        feb5d9fea6a5   </span><span class="token number" style="color:#36acaa">5</span><span class="token plain"> months ago     </span><span class="token number" style="color:#36acaa">13</span><span class="token plain">.3kB</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div></li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="容器">容器<a class="hash-link" href="#容器" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_mojV" id="建置-1">建置<a class="hash-link" href="#建置-1" title="Direct link to heading">​</a></h3><p>找不到映像檔的時候會去下載</p><ol><li><p>建立<code>$docker create [options] Image:tag</code></p><p>多數時候options用不到~~</p><ul><li>--add-host=[] 指定主機到IP位址的對映關係，host:ip</li><li>--dns=[] 為容器指定域名伺服器</li><li>-h 為容器指定主機名稱</li><li>-i 開啟容器的標準輸入模式</li><li>--name 指定容器名稱</li><li>-u, --user建立使用者</li></ul><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">yehs1225@yehs1225-VirtualBox:~$ </span><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> create ubuntu</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">6bf3e7d30d6996bef958ad17879b729aabc922564dccce31c157cfeeccd98f4d</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>建立後回傳該容器ID</p></li><li><p>建立並執行<code>$docker run [options]</code></p><ul><li>-t 互動式容器，會分配一個命令列虛擬終端給使用者互動</li><li>-d 後臺容器，保持在後台運行</li></ul></li></ol><p>​	以<code>$exit</code>退出</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="檢視">檢視<a class="hash-link" href="#檢視" title="Direct link to heading">​</a></h3><ol><li>運行中的<code>$docker ps</code></li></ol><ol start="2"><li><p>全部<code>$docker ps -a</code></p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">yehs1225@yehs1225-VirtualBox:~$ </span><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ps</span><span class="token plain"> -a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CONTAINER ID   IMAGE         COMMAND       CREATED              STATUS                          PORTS     NAMES</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">8a607c36e53f   ubuntu        </span><span class="token string" style="color:#e3116c">&quot;/bin/bash&quot;</span><span class="token plain">   About a minute ago   Exited </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> About a minute ago             demo_ubuntu</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">6bf3e7d30d69   ubuntu        </span><span class="token string" style="color:#e3116c">&quot;bash&quot;</span><span class="token plain">        </span><span class="token number" style="color:#36acaa">7</span><span class="token plain"> minutes ago        Created                                   distracted_jennings</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">640a645aac6c   ubuntu        </span><span class="token string" style="color:#e3116c">&quot;/bin/bash&quot;</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">58</span><span class="token plain"> minutes ago       Exited </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">46</span><span class="token plain"> minutes ago                 jovial_shaw</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">5c498a3dd677   hello-world   </span><span class="token string" style="color:#e3116c">&quot;/hello&quot;</span><span class="token plain">      </span><span class="token number" style="color:#36acaa">24</span><span class="token plain"> hours ago         Exited </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">24</span><span class="token plain"> hours ago                   angry_bardeen</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li>ID、NAMES不能重複</li><li>COMMAND為最後執行的指令</li></ul></li><li><p>包含特定字串的<code>$docker ps -a -f field=value</code></p><p>fields可以是name、image、status等</p></li></ol><h3 class="anchor anchorWithStickyNavbar_mojV" id="啟動">啟動<a class="hash-link" href="#啟動" title="Direct link to heading">​</a></h3><ul><li>啟動 <code>$docker start NAME</code></li><li>重新啟動 <code>$docker restart NAME</code></li></ul><h3 class="anchor anchorWithStickyNavbar_mojV" id="停止">停止<a class="hash-link" href="#停止" title="Direct link to heading">​</a></h3><ul><li><code>$docker stop [CONTAINER ID 或 NAME]</code> </li></ul><p>​		若無法停止，強制停止 <code>$docker stop -t 10 container</code>（10s）</p><ul><li>立即中止<code>$docker kill container</code> </li></ul><h3 class="anchor anchorWithStickyNavbar_mojV" id="刪除-1">刪除<a class="hash-link" href="#刪除-1" title="Direct link to heading">​</a></h3><p> <code>$docker rm [CONTAINER ID 或 NAME]</code> </p><h2 class="anchor anchorWithStickyNavbar_mojV" id="網路">網路<a class="hash-link" href="#網路" title="Direct link to heading">​</a></h2><p>網路算是Docker較弱的部分，但是我們要把Docker用得好就需要去了解更多的網路原理!先補充一下OSI模型。OSI模型（Open <strong>S</strong>ystem Interconnection Model）由國際標準化組織提出，<strong>試圖讓世界各地的電腦互連為網路的標準框架</strong>。共分為７層，每一層都定義了不同通訊協定！</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="原理">原理<a class="hash-link" href="#原理" title="Direct link to heading">​</a></h3><p>Docker為了讓容器間及容器和外部網路連接，會在宿主機內安裝 <strong>虛擬橋接器</strong>（一般情況下叫做docker0），在OSI模型中的資料連結層（Data Link Layer）作用。在docker 0 中會開名為 <code>veth*</code>的介面，來連接到容器。</p><p>可透過<code>$brctl show</code>來查看docker的資訊。</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">yehs1225@yehs1225-VirtualBox:~$ brctl show</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bridge name bridge </span><span class="token function" style="color:#d73a49">id</span><span class="token plain">       STP enabled interfaces</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">docker0     </span><span class="token number" style="color:#36acaa">8000</span><span class="token plain">.0242c32a8c88   no  </span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="模式">模式<a class="hash-link" href="#模式" title="Direct link to heading">​</a></h3><p>在建置容器時加入<code>--network</code>來指定。</p><ol><li><h4 class="anchor anchorWithStickyNavbar_mojV" id="bridgedefault">bridge（default）<a class="hash-link" href="#bridgedefault" title="Direct link to heading">​</a></h4><p>Docker用Linux中的命名空間（namespace）來隔離資源，PID - 處理程序、Mount - 檔案系統、Network - 網路。一個Network命名空間會獨立一個網路環境，包含網路卡、路由、iptable規則等。</p><p>一個容器通常就會分配到一個namespace，這就是bridge模式。</p><blockquote><p>namespace表示一個識別碼（identifier）的可見範圍，一個識別碼可在不同空間的含意是不會互相干擾的。例如兩間公司A、B，都有員工的編號為0012，但是因為兩者就處在不同namespace所以不會有搞混的情形。</p></blockquote><blockquote><p>iptables是運行在使用者空間的應用軟體，通過控制Linux核心netfilter模組，來管理網路封包的處理和轉發。</p></blockquote></li><li><h4 class="anchor anchorWithStickyNavbar_mojV" id="container">container<a class="hash-link" href="#container" title="Direct link to heading">​</a></h4><p>和指定的容器共用namespace，但是除了網路設定外，其他檔案、處理程序等還是隔離的。</p></li><li><h4 class="anchor anchorWithStickyNavbar_mojV" id="none">none<a class="hash-link" href="#none" title="Direct link to heading">​</a></h4><p>不會為容器做任何網路設定，也就是說此Docker沒有網卡、IP、路由等，需要自己添加。</p></li><li><h4 class="anchor anchorWithStickyNavbar_mojV" id="host">host<a class="hash-link" href="#host" title="Direct link to heading">​</a></h4><p>和宿主機用同一個，像是IP、通訊埠。</p></li></ol><p>嘗試建立一host模式的容器 <code>$docker run -d -ti --network=host ubuntu</code></p><p>查看容器網路參數<code>$docker exec CONTAINER_ID ip a show</code></p><h3 class="anchor anchorWithStickyNavbar_mojV" id="容器間互連">容器間互連<a class="hash-link" href="#容器間互連" title="Direct link to heading">​</a></h3><p>每個namespace都會連到虛擬橋接器docker0，所以基本上就是相通的。測試方法可先建立兩個容器，再分別查看網路參數<code>$docker exec CONTAINER_ID ip a show</code>，得到IP位址，再去兩個容器中試著連到彼此的IP（<code>$ping IP_ADDRESS</code>）</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="容器與外部網路">容器與外部網路<a class="hash-link" href="#容器與外部網路" title="Direct link to heading">​</a></h3><p>docker0連接到各容器，而docker0又是與主機相通的，所以基本上可以存取到外部網路，但若是要由外往存取容器的話就要：通訊埠對應，也就是設定主機內某個通訊埠對應到容器的網路服務通訊埠，如此一來，使用者存取主機的指定通訊埠就可以了。</p><p><code>$ docker run --publish [host port]:[container port] IMAGE</code></p><p>例如要用IMAGE <code>python-docker</code>建立容器並向外連，python-docker的port是5000，本機是8000，所以要執行容器時用</p><p><code>$ docker run --publish 8000:5000 python-docker</code></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/yehs1225/yehs1225.github.io/docs/Docker/Docker2基本管理.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/Docker/Docker1基本介紹"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Docker[1]基本介紹</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/JavaScript/JavaScript-this"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">JavaScript-this</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#拒絕存取permissiondenied" class="table-of-contents__link toc-highlight">拒絕存取（permission　denied）</a></li><li><a href="#映像檔" class="table-of-contents__link toc-highlight">映像檔</a><ul><li><a href="#尋找" class="table-of-contents__link toc-highlight">尋找</a></li><li><a href="#下載" class="table-of-contents__link toc-highlight">下載</a></li><li><a href="#列表" class="table-of-contents__link toc-highlight">列表</a></li><li><a href="#刪除" class="table-of-contents__link toc-highlight">刪除</a></li><li><a href="#查看" class="table-of-contents__link toc-highlight">查看</a></li><li><a href="#建置" class="table-of-contents__link toc-highlight">建置</a></li><li><a href="#標籤" class="table-of-contents__link toc-highlight">標籤</a></li></ul></li><li><a href="#容器" class="table-of-contents__link toc-highlight">容器</a><ul><li><a href="#建置-1" class="table-of-contents__link toc-highlight">建置</a></li><li><a href="#檢視" class="table-of-contents__link toc-highlight">檢視</a></li><li><a href="#啟動" class="table-of-contents__link toc-highlight">啟動</a></li><li><a href="#停止" class="table-of-contents__link toc-highlight">停止</a></li><li><a href="#刪除-1" class="table-of-contents__link toc-highlight">刪除</a></li></ul></li><li><a href="#網路" class="table-of-contents__link toc-highlight">網路</a><ul><li><a href="#原理" class="table-of-contents__link toc-highlight">原理</a></li><li><a href="#模式" class="table-of-contents__link toc-highlight">模式</a></li><li><a href="#容器間互連" class="table-of-contents__link toc-highlight">容器間互連</a></li><li><a href="#容器與外部網路" class="table-of-contents__link toc-highlight">容器與外部網路</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 Tzu Hsuan Yeh. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.5ff5b40d.js"></script>
<script src="/assets/js/main.0b6d2e73.js"></script>
</body>
</html>