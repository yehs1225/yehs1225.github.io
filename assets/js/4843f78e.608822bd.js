"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[6895],{3905:function(e,t,a){a.d(t,{Zo:function(){return m},kt:function(){return u}});var n=a(7294);function l(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function p(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){l(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,n,l=function(e,t){if(null==e)return{};var a,n,l={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(l[a]=e[a]);return l}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(l[a]=e[a])}return l}var s=n.createContext({}),o=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):p(p({},t),e)),a},m=function(e){var t=o(e.components);return n.createElement(s.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},k=n.forwardRef((function(e,t){var a=e.components,l=e.mdxType,r=e.originalType,s=e.parentName,m=i(e,["components","mdxType","originalType","parentName"]),k=o(a),u=l,c=k["".concat(s,".").concat(u)]||k[u]||d[u]||r;return a?n.createElement(c,p(p({ref:t},m),{},{components:a})):n.createElement(c,p({ref:t},m))}));function u(e,t){var a=arguments,l=t&&t.mdxType;if("string"==typeof e||l){var r=a.length,p=new Array(r);p[0]=k;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i.mdxType="string"==typeof e?e:l,p[1]=i;for(var o=2;o<r;o++)p[o]=a[o];return n.createElement.apply(null,p)}return n.createElement.apply(null,a)}k.displayName="MDXCreateElement"},4631:function(e,t,a){a.r(t),a.d(t,{frontMatter:function(){return i},contentTitle:function(){return s},metadata:function(){return o},toc:function(){return m},default:function(){return k}});var n=a(7462),l=a(3366),r=(a(7294),a(3905)),p=["components"],i={},s="GetStarted - build CRM [1]",o={unversionedId:"Django/[DJ]GetStartedBuildCRM[1]",id:"Django/[DJ]GetStartedBuildCRM[1]",title:"GetStarted - build CRM [1]",description:"Link : YEHCRM (yehs1225.com)",source:"@site/docs/Django/[DJ]GetStartedBuildCRM[1].md",sourceDirName:"Django",slug:"/Django/[DJ]GetStartedBuildCRM[1]",permalink:"/docs/Django/[DJ]GetStartedBuildCRM[1]",editUrl:"https://github.com/yehs1225/yehs1225.github.io/docs/Django/[DJ]GetStartedBuildCRM[1].md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"GetStarted-documents",permalink:"/docs/Django/[DJ]GetStarted-documents"},next:{title:"GetStarted - build CRM [2]",permalink:"/docs/Django/[DJ]GetStartedBuildCRM[2]"}},m=[{value:"\u5c08\u6848\u958b\u59cb\u524d",id:"\u5c08\u6848\u958b\u59cb\u524d",children:[],level:4},{value:"\u5efa\u7acbApp",id:"\u5efa\u7acbapp",children:[],level:2},{value:"\u5efa\u7acb\u8cc7\u6599\u5eab",id:"\u5efa\u7acb\u8cc7\u6599\u5eab",children:[{value:"\u5efa\u7acbtable",id:"\u5efa\u7acbtable",children:[],level:3},{value:"\u9023\u7d50\u5169table",id:"\u9023\u7d50\u5169table",children:[],level:3},{value:"\u4f7f\u7528\u8005table",id:"\u4f7f\u7528\u8005table",children:[],level:3}],level:2},{value:"\u64cd\u4f5c\u8cc7\u6599\u5eab",id:"\u64cd\u4f5c\u8cc7\u6599\u5eab",children:[{value:"Model Manager",id:"model-manager",children:[],level:4}],level:2},{value:"\u7ba1\u7406\u8005\u9801\u9762\u8a2d\u5b9a",id:"\u7ba1\u7406\u8005\u9801\u9762\u8a2d\u5b9a",children:[],level:2},{value:"View",id:"view",children:[{value:"\u57fa\u672c\u4f7f\u7528",id:"\u57fa\u672c\u4f7f\u7528",children:[],level:4}],level:2},{value:"URL Namespaces",id:"url-namespaces",children:[{value:"\u8b93url\u5728\u5b83\u8a72\u5728\u7684app\u4e2d",id:"\u8b93url\u5728\u5b83\u8a72\u5728\u7684app\u4e2d",children:[],level:4},{value:"\u8981\u770b\u6574\u500blist\u548c\u5b83\u7684detail",id:"\u8981\u770b\u6574\u500blist\u548c\u5b83\u7684detail",children:[],level:4}],level:2},{value:"Forms",id:"forms",children:[],level:2},{value:"Model Form",id:"model-form",children:[],level:2},{value:"Update View \uff08Form\uff09",id:"update-view-form",children:[],level:2},{value:"Delete View\uff08form\uff09",id:"delete-viewform",children:[],level:2},{value:"URL Names",id:"url-names",children:[{value:"path\u7684\u7b2c\u4e09\u500b\u53c3\u6578 - name",id:"path\u7684\u7b2c\u4e09\u500b\u53c3\u6578---name",children:[{value:"\u4e00\u822c\u7684html\u4e2dlink\u7684\u8b8a\u52d5",id:"\u4e00\u822c\u7684html\u4e2dlink\u7684\u8b8a\u52d5",children:[],level:5},{value:"\u6709\u5305\u542bpk\u7684",id:"\u6709\u5305\u542bpk\u7684",children:[],level:5}],level:4}],level:2},{value:"Extending Templates",id:"extending-templates",children:[{value:"\u5982\u679c\u60f3\u8981\u5f15\u7528\u5176\u4ed6\u6a94\u6848",id:"\u5982\u679c\u60f3\u8981\u5f15\u7528\u5176\u4ed6\u6a94\u6848",children:[],level:5}],level:2},{value:"TwailwindCss",id:"twailwindcss",children:[],level:2},{value:"Class Based View",id:"class-based-view",children:[{value:"CRUD",id:"crud",children:[],level:4},{value:"\u4e00\u822c\u9801\u9762 - <code>TemplateView</code>",id:"\u4e00\u822c\u9801\u9762---templateview",children:[],level:4},{value:"List\u9801\u9762 - <code>ListView</code>",id:"list\u9801\u9762---listview",children:[],level:4},{value:"Detail\u9801\u9762 - <code>DetailView</code>",id:"detail\u9801\u9762---detailview",children:[],level:4},{value:"Create\u9801\u9762 - <code>CreateView</code>",id:"create\u9801\u9762---createview",children:[],level:4},{value:"Update\u9801\u9762 - <code>UpdateView</code>",id:"update\u9801\u9762---updateview",children:[],level:4},{value:"Delete\u9801\u9762 - <code>DeleteView</code>",id:"delete\u9801\u9762---deleteview",children:[],level:4}],level:2},{value:"Set Static files",id:"set-static-files",children:[],level:2},{value:"Send Emails",id:"send-emails",children:[],level:2},{value:"Authentication",id:"authentication",children:[{value:"Login/Logout",id:"loginlogout",children:[],level:4},{value:"Sign up",id:"sign-up",children:[],level:4}],level:2},{value:"Test",id:"test",children:[{value:"1. Just In app/test.py",id:"1-just-in-apptestpy",children:[],level:4},{value:"2. Make a folder : test",id:"2-make-a-folder--test",children:[],level:4}],level:2},{value:"Auth Permissions",id:"auth-permissions",children:[{value:"\u9019\u4e0d\u662f\u8ab0\u90fd\u53ef\u4ee5\u770b\u7684\ud83d\udca2",id:"\u9019\u4e0d\u662f\u8ab0\u90fd\u53ef\u4ee5\u770b\u7684",children:[],level:4},{value:"\u4f60\u7684\u5c08\u5c6c\u5167\u5bb9",id:"\u4f60\u7684\u5c08\u5c6c\u5167\u5bb9",children:[],level:4},{value:"Signal",id:"signal",children:[],level:4},{value:"User Types",id:"user-types",children:[],level:4},{value:"\u5ba2\u88fd\u5316\u7684Mixin",id:"\u5ba2\u88fd\u5316\u7684mixin",children:[],level:4}],level:2},{value:"Password",id:"password",children:[{value:"set random password",id:"set-random-password",children:[],level:4},{value:"reset password",id:"reset-password",children:[],level:4}],level:2},{value:"Dynamic choices",id:"dynamic-choices",children:[{value:"Pass arguments from views to forms",id:"pass-arguments-from-views-to-forms",children:[],level:4},{value:"Assign agents to lead (agent in the organization)",id:"assign-agents-to-lead-agent-in-the-organization",children:[],level:4}],level:2},{value:"Filter by category",id:"filter-by-category",children:[{value:"\u6709\u4e09\u7a2e\u65b9\u6cd5\u53ef\u4ee5\u5be6\u73fe",id:"\u6709\u4e09\u7a2e\u65b9\u6cd5\u53ef\u4ee5\u5be6\u73fe",children:[],level:4}],level:2},{value:"Django Third party Packages",id:"django-third-party-packages",children:[],level:2},{value:"Deployment",id:"deployment",children:[{value:"Environment Variables",id:"environment-variables",children:[],level:3},{value:"Set up Postgresql",id:"set-up-postgresql",children:[],level:3},{value:"Whitenoise -&gt; Static files",id:"whitenoise---static-files",children:[],level:3},{value:"Digital Ocean",id:"digital-ocean",children:[],level:3},{value:"Mailgun",id:"mailgun",children:[],level:3}],level:2}],d={toc:m};function k(e){var t=e.components,i=(0,l.Z)(e,p);return(0,r.kt)("wrapper",(0,n.Z)({},d,i,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"getstarted---build-crm-1"},"GetStarted - build CRM ","[1]"),(0,r.kt)("p",null,"Link : ",(0,r.kt)("a",{parentName:"p",href:"https://django-crm.yehs1225.com/"},"YEHCRM (yehs1225.com)")),(0,r.kt)("h4",{id:"\u5c08\u6848\u958b\u59cb\u524d"},"\u5c08\u6848\u958b\u59cb\u524d"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u8a2d\u5b9a\u74b0\u5883\uff0c\u5728\u6b64\u4f7f\u7528\u7684\u662fminiconda")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u5b89\u88dddjango(3.1.4)"),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"$pip freeze > requirements.txt")," \u53ef\u4ee5\u5e6b\u6211\u5011\u8f38\u51fa\u6587\u5b57\u6a94\u4ee5\u67e5\u770b\u76ee\u524d\u7684\u5957\u4ef6dependencies")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u958b\u59cb\u5c08\u6848< djcrm >"),(0,r.kt)("p",{parentName:"li"}," ",(0,r.kt)("inlineCode",{parentName:"p"},"$django-admin startproject djcrm .")),(0,r.kt)("p",{parentName:"li"},"djcrm\u5f8c\u6709\u4e00\u7a7a\u683c\uff0c\u6703\u65b0\u589e\u4e00\u8cc7\u6599\u593e\u5728\u76ee\u524d\u5de5\u4f5c\u7684\u4f4d\u7f6e\u4e0b\u3002"))),(0,r.kt)("h2",{id:"\u5efa\u7acbapp"},"\u5efa\u7acbApp"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"\u5efa\u7acb\u4e00\u500b\u53eb\u505aleads\u7684app\uff08\u6703\u662f\u4e00\u8cc7\u6599\u593e\uff09")),(0,r.kt)("p",null,"\u200b\t\t",(0,r.kt)("inlineCode",{parentName:"p"},"$python manage.py startapp leads")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u5728project\u4e2d\u8a3b\u518aapp"),(0,r.kt)("p",{parentName:"li"},"\u5728project\u7684settings.py\u4e2d\uff0c\u8981\u5728\u8a3b\u518a\u7684app\u4e2d\u52a0\u5165leads"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},"#djcrm/settings.py\nINSTALLED_APPS=[\n    ....,\n    'leads'\n]\n")))),(0,r.kt)("h2",{id:"\u5efa\u7acb\u8cc7\u6599\u5eab"},"\u5efa\u7acb\u8cc7\u6599\u5eab"),(0,r.kt)("h3",{id:"\u5efa\u7acbtable"},"\u5efa\u7acbtable"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u5728model.py\u4e2d\u5efa\u7acbtable"),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("a",{parentName:"p",href:"https://docs.djangoproject.com/en/4.0/ref/models/fields/"},"Model field reference")),(0,r.kt)("p",{parentName:"li"},"\u57fa\u672c\u8a9e\u6cd5\u5982\u4e0b"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},"from django.db import models\n#\u4f7f\u7528models\u5167\u7684class Model\u4f86\u5efa\u7acbtable\nclass <'table_name'>(models.Model):\n    'field_name' = models.'field_type'('condition')\n#field_type : CharField\u3001IntergerField\u3001BooleanField...\n#condition : max_length=X\u3001default=X...\n")),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"CharField"),"\u4e5f\u53ef\u4ee5\u8a2d\u5b9achoices\u8b93\u4eba\u9078\u64c7"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},"class table(models.Model):\n   SOURCE_CHOICES = (\n        ('YT','YouTube'),\n       ('Google','Google'),\n        ('NewsLetter','NewsLetter'),\n    )\n#\u7b2c\u4e00\u500b\u503c\u662f\u8981\u5b58\u5165db\u7684\u5b57\u4e32\n#\u7b2c\u4e8c\u500b\u662f\u8981\u986f\u793a\u5728\u756b\u9762\u4e0a\u7684\u5b57\u4e32\n    ...\n    source = models.CharField(choices=SOURCE_CHOICES,max_length=100)\n")),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"ImageField")),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},"profile_picture = models.ImageField(blank=True,null=True)\n#blank \u4ee3\u8868\u4f7f\u7528\u8005\u53ef\u8f38\u5165\u7a7a\u767d\n#null\u4ee3\u8868db\u53ef\u63a5\u53d7null\u503c\n"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u57f7\u884cmakemigrations"),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"$python manage.py makemigrations")),(0,r.kt)("p",{parentName:"li"},"migration\u7684\u8cc7\u6599\u593e\u5167\u6703\u591a\u51fa\u4e00\u500b\u6a94\u6848000X_initial.py\uff0c\u88e1\u9762\u662f\u9019\u6b21\u65b0\u589e\u52a0\u7684table")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u57f7\u884cmigrate"),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"$python manage.py migrate")))),(0,r.kt)("h3",{id:"\u9023\u7d50\u5169table"},"\u9023\u7d50\u5169table"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u7528 ",(0,r.kt)("inlineCode",{parentName:"p"},"ForeignKey()")," \u4f86\u9023\u63a5"),(0,r.kt)("p",{parentName:"li"},"\u5728\u8981\u7576\u4f5cforiegn key\u7684\u6b04\u4f4d\u52a0\u4e0a",(0,r.kt)("inlineCode",{parentName:"p"},"ForeignKey()"),"\uff0c",(0,r.kt)("inlineCode",{parentName:"p"},"ForeignKey()"),"\u6709\u5169\u500bargs\uff0c\u4e00\u662f\u8981\u9023\u7d50\u7684table\uff1b\u4e8c\u662f",(0,r.kt)("inlineCode",{parentName:"p"},"on_delete"),"\uff0c\u4ee3\u8868\u8981\u5982\u4f55\u8655\u7f6e\u9019\u7b46\u8cc7\u6599\u7576\u9023\u7d50\u5230\u7684\u8868\u683c\u5167\u5bb9\u4e0d\u5b58\u5728\u6642\uff08\u50cf\u662f\u88ab\u522a\u9664\u4e4b\u985e\u7684\uff09\uff0c\u6709\u5e7e\u7a2e\u9078\u9805\u8a2d\u5b9a\uff1a"),(0,r.kt)("ol",{parentName:"li"},(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("inlineCode",{parentName:"li"},"models.CASCADE "),": \u627e\u4e0d\u5230foreignkey\u7684\u6307\u5411\u5c31\u522a\u9664"),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("inlineCode",{parentName:"li"},"models.SET_NULL "),":\u8a2d\u5b9a\u70banull\uff0c\u50c5\u5728\u6211\u5011\u5141\u8a31\u6b04\u4f4d\u70banull\u6642\u4f5c\u7528\uff08",(0,r.kt)("inlineCode",{parentName:"li"},"null=True"),"\uff09")),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},'class table1(models.Model):\n    {...\n    }\n    \nclass table2(models.Model):\n    {...\n    fieldX = models.ForeignKey("table1",on_delete=models.XXX)\n    }\n')))),(0,r.kt)("h3",{id:"\u4f7f\u7528\u8005table"},"\u4f7f\u7528\u8005table"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u5efa\u8b70\u5efa\u7acb\u81ea\u5df1\u7684user table"),"\uff0c\u5118\u7ba1\u4e5f\u53ef\u7528 ",(0,r.kt)("inlineCode",{parentName:"p"},"from django.contrib.quth import get_user_model"),"\u5f15\u5165User"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u5f15\u5165django\u63d0\u4f9b\u7684\u6a21\u7d44"),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"from django.contrib.auth.models import AbstractUser"),"\uff0c\u53ef\u6309\u53f3\u9375go to definition\u67e5\u770b\u3002")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u56e0\u70ba\u88e1\u9762\u5df2\u6709\u4f7f\u7528\u8005\u540d\u7a31\u3001\u4fe1\u7bb1\u7b49\u8cc7\u8a0a\uff0c\u56e0\u6b64\u7528pass\u4fdd\u7559\u539f\u672c\u7684\u8a2d\u5b9a\u5c31\u597d\u3002\u5982\u679c\u5e0c\u671b\u52a0\u4e0a\u5176\u4ed6\u6b04\u4f4d\u5c31\u76f4\u63a5\u52a0\u4e0a\u5c31\u884c\u4e86\u3002"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},"class User(AbstractUser):\n    pass\n"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u5728\u5176\u4ed6table\u8a2d\u5b9auser\u6b04\u4f4d"),(0,r.kt)("p",{parentName:"li"},"\u5e0c\u671b\u662f1\u5c0d1 : ",(0,r.kt)("inlineCode",{parentName:"p"},"OneToOneField")),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},"class table(models.Model):\n    user = models.OneToOneField(User,on_delete=models.CASCADE)\n"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u5728project\u4e2d\u7684settings.py\u544a\u77e5\u65b0\u589e\u4e86user table"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},"#djcrm/setting.py\nAUTH_USER_MODEL = 'leads.User'\n")))),(0,r.kt)("h2",{id:"\u64cd\u4f5c\u8cc7\u6599\u5eab"},"\u64cd\u4f5c\u8cc7\u6599\u5eab"),(0,r.kt)("h4",{id:"model-manager"},"Model Manager"),(0,r.kt)("p",null,"\u4f7f\u7528model manager : \u53d6\u5f97model\u7528",(0,r.kt)("inlineCode",{parentName:"p"},"model_name.objects")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u65b0\u589e\u8cc7\u6599create"),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"model_name.objects.create(field1=XX,...)"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u67e5\u8a62query"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"query all"),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"model_name.objects.all()"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"query with filter"),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},'model_name.filter(field1="XXX")'))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"\u5982\u679c\u5df2\u7d93query all\uff0c\u518d\u6839\u64da\u689d\u4ef6\u5f0f\u7528filter\uff0c\u90a3\u9ebc\u7b2c\u4e8c\u500bfilter\u5176\u5be6\u4e0d\u6703\u771f\u7684\u53bb\u7528\u5230\u8cc7\u6599\u5eab\uff0c\u56e0\u6b64\u4e0d\u7528\u64d4\u5fc3\u6548\u80fd\u6703\u8b8a\u5dee")))))),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"get \u62ff\u56de\u4e00\u7b46\u8cc7\u6599"),(0,r.kt)("p",{parentName:"li"},"get \u548c query\u4e0d\u540c\uff0c\u53ea\u6703\u6709\u4e00\u7b46\u8cc7\u6599\uff0c\u800c\u4e14\u4e0d\u662f\u67e5\u8a62\u662f\u76f4\u63a5\u53d6\u56de\uff0c\u4f46\u65b9\u6cd5\u548cfilter\u985e\u4f3c"),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},'model_name.get(field1="XXX")')),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u7576\u8981\u53d6\u7684\u8cc7\u6599\u662f\u53c3\u7167\u53e6\u4e00table\u6642\uff0c\u5728\u6b04\u4f4d\u5f8c\u52a0\u4e0a",(0,r.kt)("inlineCode",{parentName:"p"},"__"),"+",(0,r.kt)("inlineCode",{parentName:"p"},"\u6b04\u4f4d\u540d\u7a31"),"\uff0c\u4f8b\u5982\u4e00table < Agent >\u7684user\u6b04\u4f4d\u662f\u53c3\u7167table User\uff0c\u800c\u6211\u5011\u8981\u53d6\u51fa\u7279\u5b9aemail(\u6b64\u6b04\u4f4d\u5c6c\u65bctable User)\u3002"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},'get_agent = Agent.objects.get(user__email="XXX")\n'))))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u53ef\u4ee5\u7528python shell\u4f86\u64cd\u4f5c\u6307\u4ee4",(0,r.kt)("inlineCode",{parentName:"p"},"$python manage.py shell")),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u65b0\u589euser\u4f86\u6e2c\u8a66",(0,r.kt)("inlineCode",{parentName:"p"},"$python manage.py createsuperuser"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u63a5\u8005\u958b\u555fshell\u8f38\u5165\uff0c\u53ef\u770b\u5230\u4ee5\u65b0\u589e\u4f7f\u7528\u8005"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},"from django.contrib.auth import get_user_model\nUser = get_user_model()\nUser.objects.all()#<QuerySet [<User:yehs1225>]>\n")))))),(0,r.kt)("h2",{id:"\u7ba1\u7406\u8005\u9801\u9762\u8a2d\u5b9a"},"\u7ba1\u7406\u8005\u9801\u9762\u8a2d\u5b9a"),(0,r.kt)("p",null,"django\u6709\u81ea\u5df1\u63d0\u4f9b\u597d\u7528\u7684\u7ba1\u7406\u8005\u9801\u9762\uff0c\u4e00\u65e6\u5efa\u7acb\u5b8cmodel\u5c31\u53ef\u4ee5\u5728\u7db2\u9801\u4e0a\u64cd\u4f5c\u8cc7\u6599\u5eab\u3002\u4ecb\u9762\u4e0a\u4e5f\u53ef\u505a\u8abf\u6574\uff0c\u4ee5\u65b9\u4fbf\u64cd\u4f5c\u3002"),(0,r.kt)("p",null,"\u5728app\u4e2d\u7684admin.py\u4e2d\u8a2d\u5b9a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u65b0\u589e\u53ef\u88ab\u7ba1\u7406\u8005\u64cd\u4f5c\u7684models"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},"#app/admin.py\n#\u5f15\u5165\u60f3\u8981\u52a0\u5165\u7684model\nfrom .models import User, Lead, Agent\n#\u52a0\u5230admin\u7684page\u4e2d\nadmin.site.register(User)\nadmin.site.register(Lead)\nadmin.site.register(Agent)\n")))),(0,r.kt)("h2",{id:"view"},"View"),(0,r.kt)("p",null,"\u5728view\u4e2d\u5f15\u7528\u8cc7\u6599\u5eab\uff08models\uff09\uff0c\u5b9a\u7fa9\u51fd\u6578\u5206\u5225\u4ee3\u8868\u8981\u5f9e\u8cc7\u6599\u5eab\u4e2d\u57f7\u884c\u7684\u52d5\u4f5c\uff0c\u4f8b\u5982app_list \u3001 app_detail\u7b49\u7b49\u3002"),(0,r.kt)("h4",{id:"\u57fa\u672c\u4f7f\u7528"},"\u57fa\u672c\u4f7f\u7528"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u65b0\u589ehome page"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u5728app\u7684view.py\u4e2d\u65b0\u589e\u4e00\u51fd\u6578"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u7528HttpResponse\u56de\u61c9"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},'#app/view.py\nfrom django.http import HttpResponse\n\ndef home_page(request):\n    return HttpResponse("hello world")\n'))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u7528.html\u6e32\u67d3\uff08",(0,r.kt)("strong",{parentName:"p"},"templates"),"\uff09"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u6211\u5011\u9700\u8981\u5728app\u88e1\u65b0\u589e\u8cc7\u6599\u593e",(0,r.kt)("inlineCode",{parentName:"p"},"template"),"\uff0c\u518d\u88e1\u9762\u518d\u65b0\u589e\u4e00\u8cc7\u6599\u593e\uff08\u547d\u540d\u8981\u548capp\u540d\u7a31\u4e00\u6a23\uff09\uff0c\u5c07.html\u6a94\u6848\u653e\u5728\u88e1\u9762\u3002")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u5728view.py\u5247\u7528\u4ee5\u4e0b\u65b9\u6cd5"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},'#app/view.py\ndef home_page(request):\n    return render(request,"leads/home_page.html")\n')),(0,r.kt)("p",{parentName:"li"},"\u5728render\u4e2d\u53ef\u52a0\u5165\u7b2c\u4e09\u500b\u53c3\u6578\u628a\u60f3\u8981\u52a0\u5165\u9801\u9762\u7684\u5167\u5bb9\u50b3\u9001\u5230html\u4e2d"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},'#app/view.py\ndef home_page(request):\n    context = {\n        "name":"cama",\n        "age":3\n    }\n    return render(request,"leads/home_page.html",context)\n')),(0,r.kt)("p",{parentName:"li"},"\u800c\u5728html\u4e2d\u5247\u4ee5",(0,r.kt)("inlineCode",{parentName:"p"},"{{ NameOfKey }}"),"\u4f7f\u7528"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-html"},"...\n{{name}}\n{{age}}\n...\n")),(0,r.kt)("p",{parentName:"li"},"\u5982\u679c\u6709\u591a\u7b46\u8cc7\u6599\u50b3\u5165\u6642\u53ef\u7528"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-django"},"{% for item in list %}\n    {{item}}\n{% endfor %}\n"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u5728project\u7684setting.py\u4e2d\u8a2d\u5b9atemplate"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},"#project/setting.py\nTEMPLATES = [\n    {\n    ...\n        'DIRS': [BASE_DIR/\"templates\"],\n    ...\n    },\n]\n"))))))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u5728project\u7684urls.py\u4e2d\u5f15\u5165\u4e26\u52a0\u5165\u8981\u9023\u7d50\u7684\u5730\u5740"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},"#project/urls.py\nfrom leads.views import home_page\nurlpatterns = [\n    ...,\n    path('',home_page)\n]\n")))))),(0,r.kt)("h2",{id:"url-namespaces"},"URL Namespaces"),(0,r.kt)("h4",{id:"\u8b93url\u5728\u5b83\u8a72\u5728\u7684app\u4e2d"},"\u8b93url\u5728\u5b83\u8a72\u5728\u7684app\u4e2d"),(0,r.kt)("p",null,"\u6211\u5011\u5728project\u4e2d\u7684urls.py\u8981\u544a\u8a34\u9019\u500b\u5c08\u6848\uff0c\u6709\u7528\u5230\u54ea\u500bapp\u5c31\u53bb\u90a3\u500bapp\u4e2d\u627e\u3002"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u5728app\u4e2d\u65b0\u589eurls.py\u9019\u500b\u6a94\u6848"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},"#app/urls.py\nfrom django.urls import path\nfrom .views import home_page\n\napp_name = 'leads'\n\nurlpatterns = [\n    path('all/',home_page)\n]\n"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u544a\u8a34project\u8981\u53bbapp\u4e2d\u627e\u9023\u7d50"),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"import include")),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},"#project/urls.py\nfrom django.contrib import admin\nfrom django.urls import path,include\n\nurlpatterns = [\n    path('admin/', admin.site.urls),\n    path('app_name/',include('app_name.urls',namespace=\"app_name\"))\n]\n")))),(0,r.kt)("h4",{id:"\u8981\u770b\u6574\u500blist\u548c\u5b83\u7684detail"},"\u8981\u770b\u6574\u500blist\u548c\u5b83\u7684detail"),(0,r.kt)("p",null,"\u5047\u8a2d\u6211\u5011\u73fe\u5728\u6709\u500b\u7db2\u9801\u50c5\u5217\u51fa\u5217\u8868\uff08list\uff09\uff0c\u6bcf\u5217\u5448\u73fe\u4f7f\u7528\u8005\u59d3\u540d\uff0c\u4e26\u4e14\u5e0c\u671b\u80fd\u5920\u900f\u904e\u7279\u5b9a\u7684primary key number\u4f5c\u7528\u65bcurls\u4ee5\u9023\u7d50\u5230\u6307\u5b9a\u4f7f\u7528\u8005\u7684\u8a73\u7d30\u8a0a\u606f\uff08detail\uff09\u3002\u4e0b\u5716\u7684id\u5c31\u662f\u6b64table\u7684primary key\uff0c\u4f8b\u5982\u6211\u5011\u5e0c\u671b\u8f38\u51651\u6642\u5c31\u5e36\u5f80Joe\u7684\u9801\u9762\u3002"),(0,r.kt)("p",null,(0,r.kt)("img",{src:a(4885).Z,width:"352",height:"104"})),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u9996\u5148\u6211\u5011\u5728view.py\u4e2d\u65b0\u589e\u4e00\u51fd\u6578\uff0c\u63a5\u6536",(0,r.kt)("inlineCode",{parentName:"p"},"request"),"\u53ca",(0,r.kt)("inlineCode",{parentName:"p"},"pk")),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},'#app/view.py\ndef lead_detail(reauest,pk):\n    print(pk)#\u986f\u793a\u5728terminal\n    return HttpResponse("here is the detail view")\n'))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u63a5\u8005\u5728urls.py\u4e2d\u4ee5",(0,r.kt)("inlineCode",{parentName:"p"},"<int:pk>/"),"\u8b93\u8def\u5f91\u5728\u63a5\u6536\u5230pk\u6642\u6703\u4f7f\u7528detail\u9019\u500b\u51fd\u6578"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},"#app/urls.py\nurlpatterns = [\n    path('',lead_list),\n    path('<int:pk>/',lead_detail)\n]\n"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u5e0c\u671b\u5728\u539f\u672chtml\u9801\u9762\u4e2d\u65b0\u589e< a >tag\uff0c\u5982\u6b64\u4e00\u4f86\u7576\u6211\u5011\u9ede\u64ca\u67d0\u500b\u4f7f\u7528\u8005\u5f8c\uff0c\u5c31\u6703\u5c07\u9801\u9762\u5e36\u5411\u8a72\u4f7f\u7528\u8005\u7684\u8a73\u7d30\u5167\u5bb9\u3002"),(0,r.kt)("p",{parentName:"li"},"\u53ef\u4ee5\u76f4\u63a5\u5728",(0,r.kt)("inlineCode",{parentName:"p"},"href"),"\u7528",(0,r.kt)("inlineCode",{parentName:"p"},"key.pk")),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-django"},'{% for lead in leads %}\n    <div class="lead">\n        <a href="/leads/{{lead.pk}}/">{{lead.first_name}} {{lead.last_name}}</a>. Age: {{lead.age}}\n    </div>\n{% endfor %}\n'))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u78ba\u8a8d\u53ef\u904b\u4f5c\u5f8c\u5c31\u53ef\u4ee5\u65b0\u5efa\u4e00\u500bhtml\u9801\u9762for detail\uff0c\u4e26\u5c07httpResponse\u6539\u70barender"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},"#app/view.py\ndef lead_detail(request,pk):\n    lead = Lead.objects.get(id=pk)\n    context = {\n        'lead':lead\n    }\n    return render(request,\"leads/lead_detail.html\",context)\n")))),(0,r.kt)("h2",{id:"forms"},"Forms"),(0,r.kt)("p",null,"\u5e0c\u671b\u80fd\u5920\u63d0\u4ea4\u8868\u55ae\u4f86\u65b0\u589e\u4f7f\u7528\u8005\u7b49\uff0c\u65b0\u589e\u4f7f\u7528\u8005\u5728admin\u4e2d\u53ef\u4ee5\u8fa6\u5230\uff0c\u4f46\u5728\u6b64\u5e0c\u671b\u53ef\u4ee5\u5229\u7528\u7db2\u9801\u63d0\u4ea4\u8868\u55ae\u7684\u65b9\u5f0f\u3002"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u65b0\u589ecreate.html\u5728templates/app\u5167")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u65b0\u589e\u8def\u5f91\u5728app/urls.py"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},"#app/urls.py\nurlpatterns = [\n    path('',lead_list),\n    path('create/',lead_detail),\n    path('<int:pk>/',lead_create)#\u7b49\u6703\u8981\u5728view.py\u4e2d\u65b0\u589e\u4e00\u51fd\u6578create\n]\n"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u5728app\u5e95\u4e0b\u65b0\u5efaforms.py"),(0,r.kt)("p",{parentName:"li"},"\u53ef\u4ee5\u628aapp\u4e2d\u6240\u6709\u8981\u7528\u5230\u8868\u55ae\u5b9a\u7fa9\u5728\u9019\u88e1\uff0c\u518d\u5728view.py\u4e2d\u5f15\u5165"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},"#app/forms.py\nfrom django import forms#\u5f15\u7528forms\u6a21\u7d44\nclass LeadForm(forms.Form):#\u4f7f\u7528forms\u4e2d\u7684Form\n    first_name=forms.CharField()\n    last_name = forms.CharField()\n    age=forms.IntegerField(min_value=0)\n"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u5728view.py\u4e2d\u4f7f\u7528forms"),(0,r.kt)("p",{parentName:"li"},"\u4e3b\u8981\u7684\u6b65\u9a5f\u5982\u4e0b"),(0,r.kt)("ol",{parentName:"li"},(0,r.kt)("li",{parentName:"ol"},"\u5f9eforms.py\u5f15\u7528\u9700\u8981\u7684form"),(0,r.kt)("li",{parentName:"ol"},"\u5728context\u4e2d\u5148\u586b\u5165form ",(0,r.kt)("inlineCode",{parentName:"li"},"form = LeadForm()")),(0,r.kt)("li",{parentName:"ol"},"\u6aa2\u67e5\u662f\u5426\u70baPOST ",(0,r.kt)("inlineCode",{parentName:"li"},'if request == "POST"'),"\uff0c\u662f\u5247\u586b\u5165request",(0,r.kt)("inlineCode",{parentName:"li"},"form = LeadForm(request.POST)")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("inlineCode",{parentName:"li"},"form.is_valid()"),"django\u6aa2\u67e5\u662f\u5426\u6709\u6548"),(0,r.kt)("li",{parentName:"ol"},"\u7528",(0,r.kt)("inlineCode",{parentName:"li"},"form.cleaned_data"),'\u62ff\u5230"\u4e7e\u6de8"\u7684\u8cc7\u6599\u4e26\u53d6\u51fa'),(0,r.kt)("li",{parentName:"ol"},"\u6709\u7279\u5b9a\u6b04\u4f4d\u7121\u6cd5\u5f9e\u53d6\u5f97\uff0c\u53ef\u8003\u616e\u62ff\u51fa\u8a72table\u4e2d\u7684\u7b2c\u4e00\u7b46\u8cc7\u6599\u4f86\u7528",(0,r.kt)("inlineCode",{parentName:"li"},"table.objects.first()")),(0,r.kt)("li",{parentName:"ol"},"\u5efa\u7acb\u8cc7\u6599",(0,r.kt)("inlineCode",{parentName:"li"},"table.objects.create(...)")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("inlineCode",{parentName:"li"},"redirect"),"\u5c0e\u56de\u9801\u9762\uff0c\uff08\u9808",(0,r.kt)("inlineCode",{parentName:"li"},"from django.shortcuts import redirect"),"\uff09")),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},"#app/veiws.py\n...\nfrom django.shortcuts import redirect\nfrom .models  import Agent\nfrom .forms import LeadForm\n\ndef lead_create(request):\n    form = LeadForm()\n    if request.method==\"POST\":\n        print('Receiving a post request')\n        form = LeadForm(request.POST) \n        if form.is_valid():#check form\n            print(\"the form is valid\")\n            print(form.cleaned_data)#got{'first_name': 'Sally', 'last_name': 'Somul', 'age': 28}\n            first_name = form.cleaned_data['first_name']\n            last_name = form.cleaned_data['last_name']\n            age = form.cleaned_data['age']\n            #because we don't get agent from form\n            agent = Agent.objects.first()#got first row of Agent\n            Lead.objects.create(\n                first_name = first_name,\n                last_name = last_name,\n                age = age,\n                agent = agent\n            )\n            print(\"lead created\")\n            return redirect('/leads')\n    context={\n        \"form\":form\n    }\n    return render(request,\"leads/lead_create.html\",context)\n"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u5728html\u6a94\u4e2d\u8a2d\u5b9a"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u5728\u5f15\u7528\u8981\u7528form tag\u5305\u8d77\u4f86\uff0c\u624d\u53ef\u4ee5\u63d0\u4ea4"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-django"},'//app/templates/app/create.html\n\n<form method="post">\n    {% csrf_token %}{% comment %} \u9632\u6b62csrf {% endcomment %}\n    {{form.as_p}}\n    <button>submit</button>\n</form>\n'))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u5f15\u7528\u50b3\u5165\u53c3\u6578\u6642\uff0c\u53ef\u4ee5\u8a2d\u5b9a\u5448\u73fe\u6a23\u5f0f\uff0c\u4f8b\u5982\u4e0b\u9762\u53f3\u908a\u4ee5< p > paragh\u5448\u73fe\u3002"))))),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"{{form}}"),(0,r.kt)("th",{parentName:"tr",align:null},"{{form.as_p}}"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("img",{src:a(8289).Z,width:"933",height:"140"})),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("img",{src:a(8289).Z,width:"933",height:"140"}))))),(0,r.kt)("h2",{id:"model-form"},"Model Form"),(0,r.kt)("p",null,"\u9664\u4e86\u4e0a\u9762\u81ea\u5df1\u505a\u4e00\u500bform\u4e4b\u5916\uff0c\u53ef\u4ee5\u7528django\u63d0\u4f9b\u7684ModelForm\u76f4\u63a5\u628amodel\u8b8a\u6210form\u3002"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u5728forms.py\u8a2d\u5b9amodel form"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},"#app/forms.py\nfrom .models import Lead\n\nclass Table1ModelForm(forms.ModelForm):\n    model = Lead\n    fields = (\n        field1,#field in the table\n        ...,\n        field4\n    )\n"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u5728view.py\u4e2d\u66f4\u6539\u51fd\u6578\u5167\u5bb9"),(0,r.kt)("p",{parentName:"li"},"\u5c07\u4e4b\u524d\u7528\u5230",(0,r.kt)("inlineCode",{parentName:"p"},"Table1Form"),"\u6539\u6210",(0,r.kt)("inlineCode",{parentName:"p"},"Table1ModelForm"),"\uff0c\u9019\u6642\u8868\u55ae\u5c31\u6703\u6536\u5230\u539f\u672ctable\u6240\u9700\u8981\u7684\u6240\u6709\u6b04\u4f4d\uff0c\u6240\u4ee5\u4e4b\u524d\u53d6\u7528table2\u4e2d\u7684\u7b2c\u4e00\u7b46\u8cc7\u6599\u7684\u505a\u6cd5\u4e5f\u53ef\u6539\u56de\u4f7f\u7528\u4f7f\u7528\u8005\u8f38\u5165\u7684\u8cc7\u6599\u5c31\u884c\u3002"),(0,r.kt)("p",{parentName:"li"},"\u6b64\u5916\uff0c\u56e0\u70ba\u6211\u5011\u5df2\u7d93\u5728forms.py\u4e2d\u5efa\u7acbModelForm\u6307\u5b9a\u8981\u4f7f\u7528\u54ea\u500bmodel\uff0c\u6240\u4ee5\u4e5f\u53ef\u4ee5\u628a\u78ba\u8a8d",(0,r.kt)("inlineCode",{parentName:"p"},"form.is_valid():"),"\u4e4b\u5f8c"),(0,r.kt)("p",{parentName:"li"},"\u8981\u53d6\u51fa\u8cc7\u6599\u518d\u653e\u5165table\u4e2d\u7684\u52d5\u4f5c"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},"first_name = form.cleaned_data['first_name']\nlast_name = form.cleaned_data['last_name']\nage = form.cleaned_data['age']\nagent = form.cleaned_data['agent']\nLead.objects.create(\n    first_name = first_name,\n    last_name = last_name,\n    age = age,\n    agent = agent\n)\n")),(0,r.kt)("p",{parentName:"li"},"\u7c21\u5316\u70ba"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},"form.save()\n")))),(0,r.kt)("p",null,"\u200b\t\t\u5167\u53ef\u50b3\u53c3\u6578\uff0c\u4f8b\u5982",(0,r.kt)("inlineCode",{parentName:"p"},"commit=False"),"\u4ee3\u8868\u4e0d\u8981\u99ac\u4e0a\u50b3\u5230model\uff0c\u6211\u5011\u53ef\u7528object\u5132\u5b58\u76ee\u524dform\u5f97\u5230\u7684\u72c0\u614b\uff0c\u5728\u9032\u884c\u984d\u5916\u64cd\u4f5c\uff0c\u6240\u4ee5\u53ef\u8b8a\u6210",(0,r.kt)("inlineCode",{parentName:"p"},"obj=form.save(commit=False)")),(0,r.kt)("h2",{id:"update-view-form"},"Update View \uff08Form\uff09"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u5b9a\u7fa9\u65b0\u51fd\u6578\u5728app/view.py"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},"#app/view.py\ndef lead_update(request,pk):\n    lead =Lead.objects.get(id=pk)\n    form = LeadForm()\n    if request.method==\"POST\":\n        form = LeadForm(request.POST) \n        if form.is_valid():\n            first_name = form.cleaned_data['first_name']\n            last_name = form.cleaned_data['last_name']\n            age = form.cleaned_data['age']\n            lead.first_name = first_name\n            lead.last_name = last_name\n            lead.age = age\n            lead.save()\n            return redirect('/leads')\n    context = {\n        \"form\":form,\n        'lead':lead\n    }\n    return render(request,\"app/lead_update.html\",context)\n")),(0,r.kt)("p",{parentName:"li"},"\u8ddfcreate\u4e00\u6a23\uff0c\u4e5f\u53ef\u6539\u7528\u8f03\u7c21\u6f54\u7684\u65b9\u5f0f"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},'#app/view.py\ndef lead_update(request,pk):\n    lead = Lead.objects.get(id=pk)\n    form = LeadModelForm(instance=lead)\n    if request.method=="POST":\n        form = LeadModelForm(request.POST,instance=lead) \n        if form.is_valid():\n            form.save()\n            return redirect(\'/leads\')\n    context = {\n        "form":form,\n        \'lead\':lead\n    }\n    return render(request,"leads/lead_update.html",context)\n'))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u65b0\u589eapp/templates/update.html"),(0,r.kt)("p",{parentName:"li"},"\u57fa\u672c\u4e0a\u8ddfcreate\u4e00\u6a23"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-django"},'//app/templates/update.html\n<form method="post">\n        {% csrf_token %}\n        {{form.as_p}}\n        <button>submit</button>\n</form>\n'))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u5728app/urls.py\u4e2d\u8981\u65b0\u589epath"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},"#app/urls.py\npath('<int:pk>/update/',lead_update),\n")))),(0,r.kt)("h2",{id:"delete-viewform"},"Delete View\uff08form\uff09"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u5b9a\u7fa9\u65b0\u51fd\u6578\u5728app/view.py"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},"def lead_delete(request,pk):\n    lead=Lead.objects.get(id=pk)\n    lead.delete()\n    return redirect('/leads')\n"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u5728app/urls.py\u52a0\u4e0apath"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},"urlpatterns = [\n    ...\n    path('<int:pk>/delete/',lead_delete),\n    ...\n]\n"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u5728detail.html\u52a0\u4e0a\u522a\u9664\u7684link"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-django"},'<a href="/leads/{{ lead.pk }}/delete">Delete</a>\n')))),(0,r.kt)("h2",{id:"url-names"},"URL Names"),(0,r.kt)("p",null,"\u73fe\u5728\u7684app/urls.py\u4e2d\u7684path\u9577\u9019\u6a23"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"#app/urls.py\nurlpatterns = [\n    path('',lead_list),\n    path('<int:pk>/',lead_detail),\n    path('<int:pk>/update/',lead_update),\n    path('<int:pk>/delete/',lead_delete),\n    path('create/',lead_create),\n]\n")),(0,r.kt)("p",null,"\u4e5f\u5c31\u662f\u8aaa\uff0c\u6211\u5011\u5728\u7db2\u5740\u5217\u8f38\u5165\u5c0d\u61c9\u7684\u5b57\u4e32\u5c31\u80fd\u9032\u5230\u8a72\u8def\u5f91\u4f4d\u7f6e\uff0c\u7136\u800c\uff0c\u6709\u6642\u5019\u6211\u5011\u6703\u5e0c\u671b\u53ef\u4ee5\u66f4\u6539\u986f\u793a\u5728\u7db2\u5740\u5217\u7684\u5b57\uff0c\u65bc\u662f\u5c07path\u4e2d\u7684\u7b2c\u4e00\u500b\u53c3\u6578\u4f8b\u5982",(0,r.kt)("inlineCode",{parentName:"p"},"create"),"\u76f4\u63a5\u6539\u6210",(0,r.kt)("inlineCode",{parentName:"p"},"create-a-lead"),"\uff0c\u9019\u6a23\u78ba\u5be6\u662f\u6539\u597d\u4e86\u6c92\u932f\uff0c\u4f46\u662f\u4f46\u662f!\u5982\u679c\u5728\u5176\u4ed6.html\u7684< a > tag\u4e2d\u7684",(0,r.kt)("inlineCode",{parentName:"p"},"href"),"\u6709\u6307\u5411",(0,r.kt)("inlineCode",{parentName:"p"},"/create"),"\u7684\u8a71\u5c31\u5fc5\u9808\u8981\u90fd\u66f4\u6539\uff0c\u8981\u5728\u832b\u832b\u4eba\u6d77\u4e2d\u5c0b\u627e\u5be6\u5728\u4e0d\u5bb9\u6613\u3002\u9019\u4e5f\u662f\u70ba\u4f55\u6211\u5011\u61c9\u8a72\u8981\u907f\u514d",(0,r.kt)("strong",{parentName:"p"},"hardcode"),"\u51fa\u73fe\u7684\u539f\u56e0\u3002"),(0,r.kt)("h4",{id:"path\u7684\u7b2c\u4e09\u500b\u53c3\u6578---name"},"path\u7684\u7b2c\u4e09\u500b\u53c3\u6578 - name"),(0,r.kt)("p",null,"\u8981\u907f\u514dhardcode\u51fa\u73fe\uff0c\u5c31\u662f\u52a0\u4e0a\u7b2c\u4e09\u500b\u53c3\u6578\uff0c\u4e26\u4e14\u5728\u5176\u4ed6\u9700\u8981\u9023\u7d50\u5230\u7684\u5730\u65b9\u90fd\u662f\u7528name\u6240\u8a2d\u5b9a\u597d\u7684\u5b57\u4e32\uff0c\u5982\u6b64\u4e00\u4f86\u4ee5\u5f8c\u8981\u6539\u986f\u793a\u5728\u7db2\u5740\u5217\u7684\u5b57\u4e32\u6642\u5c31\u4e0d\u7528\u64d4\u5fc3!"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"#app/urls.py\nurlpatterns = [\n    path('',lead_list,name='lead-list'),\n    path('<int:pk>/',lead_detail,name='lead-detail'),\n    path('<int:pk>/update/',lead_update,name='lead-update'),\n    path('<int:pk>/delete/',lead_delete,name='lead-delete'),\n    path('create/',lead_create,name='lead-create'),\n]\n")),(0,r.kt)("p",null,"\u800c\u5728\u5404html\u6a94\u6848\u4e2d\uff0c\u5247\u53ef\u5c07",(0,r.kt)("inlineCode",{parentName:"p"},"href"),"\u6539\u70ba",(0,r.kt)("inlineCode",{parentName:"p"},"{% url 'leads:XXXX' %}"),"\u7684\u5f62\u5f0f\uff0c\u7b2c\u4e00\u500b",(0,r.kt)("inlineCode",{parentName:"p"},"leads"),"\u662f\u56e0\u70ba\u6211\u5011\u5728project\u4e2d\u7684urls.py\u6709\u9019\u4e00\u884c",(0,r.kt)("inlineCode",{parentName:"p"},"path('leads/',include('leads.urls',namespace=\"leads\"))"),"\uff0c\u800c",(0,r.kt)("inlineCode",{parentName:"p"},":"),"\u4e4b\u5f8c\u63a5\u7684",(0,r.kt)("inlineCode",{parentName:"p"},"XXX"),"\u5c31\u662f\u6211\u5011\u5728",(0,r.kt)("inlineCode",{parentName:"p"},"name"),"\u6240\u8a2d\u5b9a\u7684\u3002"),(0,r.kt)("h5",{id:"\u4e00\u822c\u7684html\u4e2dlink\u7684\u8b8a\u52d5"},"\u4e00\u822c\u7684html\u4e2dlink\u7684\u8b8a\u52d5"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-django"},'//\u539f\u59cb\n<a href="/leads/create">Create a new Lead</a>\n//\u8b8a\u6210\n<a href="{% url \'leads:lead-create\' %}">Create a new Lead</a>\n')),(0,r.kt)("h5",{id:"\u6709\u5305\u542bpk\u7684"},"\u6709\u5305\u542bpk\u7684"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-django"},'//\u539f\u59cb\n<a href="/leads/{{lead.pk}}/">{{lead.first_name}} {{lead.last_name}}</a>. Age: {{lead.age}}\n//\u8b8a\u6210\n<a href="{% url \'leads:lead-detail\' lead.pk %}">{{lead.first_name}} {{lead.last_name}}</a>. Age: {{lead.age}}\n')),(0,r.kt)("h2",{id:"extending-templates"},"Extending Templates"),(0,r.kt)("p",null,"\u56e0\u70ba\u6211\u5011\u5275\u9020\u7684create\u3001detail\u3001update....\u7b49\u7b49\u6240\u6709\u7684html\u90fd\u5f88\u76f8\u4f3c\uff0c\u56e0\u6b64\u61c9\u8a72\u505a\u4e9b\u512a\u5316\uff0c\u907f\u514d\u91cd\u8907\u505a\u540c\u6a23\u7684\u4e8b\u60c5\u3002"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u5728\u6700\u5916\u5c64\uff08at the same layer of project and apps\uff09\u65b0\u589etemplates\u8cc7\u6599\u593e\uff0c\u4e26\u65b0\u589ebase.html\uff08\u53d6\u53ebbase\u662f\u6163\u4f8b\uff09"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u653e\u5165\u76f8\u540c\u7684\u6771\u897f\u4f8b\u5982\u6574\u500bhtml\u5927\u7db1\u3001title\u3001sytle\u7b49\u7b49"),(0,r.kt)("li",{parentName:"ul"},"\u5728",(0,r.kt)("inlineCode",{parentName:"li"},"body"),"\u90e8\u5206\uff0c\u5247\u662f\u7528",(0,r.kt)("inlineCode",{parentName:"li"},"{% block content %}"),"\u3001",(0,r.kt)("inlineCode",{parentName:"li"},"{% endblock content %}"),"\u5305\u4f4f\uff0c\u4ee3\u8868\u5230\u6642\u5019\u8981\u88ab\u6e32\u67d3\u7684\u6771\u897f\u6703\u653e\u5728\u9019\u500b",(0,r.kt)("inlineCode",{parentName:"li"},"block"),"\u4e2d")),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-html"},'<!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <style>\n        .lead{\n            padding:10px 6px;\n            margin-top:10px;\n            background-color:#f6f6f6;\n            width:100%;\n        }\n    </style>\n    <title>YEHCRM</title>\n</head>\n\n<body>\n    {% block content %}\n    {% endblock content %}\n</body>\n</html> \n')))),(0,r.kt)("ol",{start:2},(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u628a\u539f\u5148html\u4e2d\u5f88\u76f8\u4f3c\u7684\u5730\u65b9\u522a\u9664"),(0,r.kt)("p",{parentName:"li"},"\u4ee5lead_list\u4f86\u8aaa\u5c31\u662f\u9664\u4e86\u9019\u6bb5\u4ee5\u5916\u7684\u3002"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u5728\u958b\u982d\u52a0\u4e0a",(0,r.kt)("inlineCode",{parentName:"li"},'{% extends "base.html" %}')),(0,r.kt)("li",{parentName:"ul"},"\u4e26\u7528",(0,r.kt)("inlineCode",{parentName:"li"},"{% block content %}"),"\u3001",(0,r.kt)("inlineCode",{parentName:"li"},"{% endblock content %}"),"\u5305\u4f4f\u8981\u88ab\u6e32\u67d3\u7684\uff08\u5c31\u662f\u4e0b\u9762\u9019\u5340\u584a\uff09")),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-django"},'{% extends "base.html" %}\n\n{% block content %}\n\n    <a href="{% url \'leads:lead-create\' %}">Create a new Lead</a>\n    <hr/>\n    <h1>This is all or our list</h1>\n    {% for lead in leads %}\n        <div class="lead">\n            <a href="{% url \'leads:lead-detail\' lead.pk %}">{{lead.first_name}} {{lead.last_name}}</a>. Age: {{lead.age}}\n        </div>\n    {% endfor %}\n\n{% endblock content %}\n')))),(0,r.kt)("h5",{id:"\u5982\u679c\u60f3\u8981\u5f15\u7528\u5176\u4ed6\u6a94\u6848"},"\u5982\u679c\u60f3\u8981\u5f15\u7528\u5176\u4ed6\u6a94\u6848"),(0,r.kt)("p",null,"\u4f8b\u5982\u5728\u548cbase.html\u540c\u5c64\u65b0\u589e\u4e00\u500bscripts.html\uff0c\u5728base\u4e2d\u7528",(0,r.kt)("inlineCode",{parentName:"p"},"{% include%}"),"\u5f15\u7528"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-django"},'{% block content %}\n{% endblock content %}\n{% include "script.html" %}\n')),(0,r.kt)("h2",{id:"twailwindcss"},"TwailwindCss"),(0,r.kt)("p",null,"Found useful component here ! ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/aniftyco/awesome-tailwindcss"},"https://github.com/aniftyco/awesome-tailwindcss")),(0,r.kt)("p",null,"\u4e0b\u9762\u9019\u88e1\u662f\u7528",(0,r.kt)("a",{parentName:"p",href:"https://tailblocks.cc/"},"https://tailblocks.cc/")),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u5728base.html\u5f15\u7528"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-html"},'<script src="https://cdn.tailwindcss.com"><\/script>\n'))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u5efa\u7acbnavbar"),(0,r.kt)("ol",{parentName:"li"},(0,r.kt)("li",{parentName:"ol"},"\u5728twailwind\u4e2d\u627e\u5230\u9069\u7528\u7684\u6a21\u677f\u5f8c\uff0c\u5728\u8207base.html\u540c\u5c64\u7684\u5730\u65b9\u65b0\u5efanavbar.html\uff0c\u4e26\u5c07code\u8cbc\u5165"),(0,r.kt)("li",{parentName:"ol"},"\u5728base.html\u5f15\u5165\uff08",(0,r.kt)("inlineCode",{parentName:"li"},'{% include "navbar.html" %}'),"\uff09"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u5efa\u7acb\u767b\u5165\u9801\u9762"),(0,r.kt)("ol",{parentName:"li"},(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u5efa\u7acblanding.html")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u5728app/views.py\u4e2d\u5b9a\u7fa9\u65b0\u51fd\u6578"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},'def leading_page(request):\n    return render(request,"landing.html")\n'))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u5728project\u4e2d\u7684urls.py\u65b0\u589e\u8def\u5f91"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},"from leads.views import landing_page#\u5f15\u5165\u525b\u5b9a\u7fa9\u597d\u7684\u51fd\u6578\n\nurlpatterns = [\n    ..\n    path('',landing_page,name='landing-page'),\n    ..\n]\n\n"))))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u70ba\u5df2\u5b58\u5728\u7684html\u52a0\u4e0atwailwind css"),(0,r.kt)("p",{parentName:"li"},"\u76f4\u63a5\u52a0\u5728",(0,r.kt)("inlineCode",{parentName:"p"},"{% block content %}"),"\u5167"))),(0,r.kt)("h2",{id:"class-based-view"},"Class Based View"),(0,r.kt)("p",null,"\u4e4b\u524d\u90fd\u662f\u7528function based view\uff0c\u4f86handle request\uff0c\u800c\u7528class\u53ef\u4ee5\u6e1b\u5c11\u5f88\u591acode\uff0cDjango\u5c31\u63d0\u4f9b\u4e86",(0,r.kt)("inlineCode",{parentName:"p"},"django.views.generic"),"\u9019\u500b\u6a21\u7d44\uff0c\u88e1\u9762\u53ef\u4ee5\u5f15\u7528\u5404\u7a2eview\u4f86\u4f7f\u7528\uff0c\u4e4b\u5f8c\u518d\u5230urls.py\u4f5c\u76f8\u5c0d\u61c9\u7684\u4fee\u6b63\u3002"),(0,r.kt)("h4",{id:"crud"},"CRUD"),(0,r.kt)("p",null,"Create, Retrieve, Update and Delete + List."),(0,r.kt)("p",null,"\u57fa\u672c\u4e0a\u6240\u6709\u7684\u7db2\u9801\u90fd\u53ef\u7531\u9019\u4e9b\u52d5\u4f5c\u5b8c\u6210\uff0c\u56e0\u6b64Django\u5f88\u8cbc\u5fc3\u7684\u63d0\u4f9b\u4e86\u9019\u4e9bView\u8b93\u6211\u5011\u4f7f\u7528\uff0c\u6bcf\u500bview\u4e2d\u6700\u57fa\u790e\u7684\u8a2d\u5b9a\u5c31\u662f",(0,r.kt)("inlineCode",{parentName:"p"},"template_name"),"\u3002\u4ee5\u4e0b\u5c0d\u5404\u7a2e\u60c5\u6cc1\u5206\u5225\u9032\u884c\u4fee\u6539\uff1a"),(0,r.kt)("h4",{id:"\u4e00\u822c\u9801\u9762---templateview"},"\u4e00\u822c\u9801\u9762 - ",(0,r.kt)("inlineCode",{parentName:"h4"},"TemplateView")),(0,r.kt)("p",null,"e.g.Landing_page"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"template_name")),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("h5",{parentName:"li",id:"\u4fee\u6539viewspy\u7684func--class-based"},"\u4fee\u6539views.py\u7684func => class based"),(0,r.kt)("p",{parentName:"li"},"\u539f\u5148\u7684function"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},'#app/views.py\ndef landing_page(request):\n    return render(request,"landing.html")\n')),(0,r.kt)("p",{parentName:"li"},"\u5f15\u7528TemplateView"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},'#app/views.py\nfrom django.views.generic import TemplateView\n\nclass LandingPageView(TemplateView):\n    template_name="landing.html"\n'))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("h5",{parentName:"li",id:"\u4fee\u6539\u5728projecturlspy\u4e2d\u5f15\u7528\u7684\u6a21\u7d44\u53ca\u8def\u5f91"},"\u4fee\u6539\u5728project/urls.py\u4e2d\u5f15\u7528\u7684\u6a21\u7d44\u53ca\u8def\u5f91"),(0,r.kt)("p",{parentName:"li"},"\u5f15\u5165ClassBasedView\u5f8c\uff0c\u4ee5",(0,r.kt)("inlineCode",{parentName:"p"},"ClassBasedView.as_view()"),"\u7684\u65b9\u5f0f\u547c\u53eb"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},"from leads.views import landing_page,LandingPageView\n\nurlpatterns = [\n.. path('',LandingPageView.as_view(),name='landing-page'),\n..\n]\n")))),(0,r.kt)("h4",{id:"list\u9801\u9762---listview"},"List\u9801\u9762 - ",(0,r.kt)("inlineCode",{parentName:"h4"},"ListView")),(0,r.kt)("p",null,"e.g.lead_list"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"template_name")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"queryset"),":\u653e\u5165\u8981\u64cd\u4f5c\u8cc7\u6599\u5eab\u7684\u90e8\u5206\u3002"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"context_object_name"),"optional but recommend\uff08\u8aaa\u660e\u5728\u7b2c\u4e09\u9edehtml\uff09"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("h5",{parentName:"li",id:"\u4fee\u6539viewspy\u7684func--class-based-1"},"\u4fee\u6539views.py\u7684func => class based"),(0,r.kt)("p",{parentName:"li"},"\u539f\u5148\u7684function"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},"def lead_list(request):\n    leads = Lead.objects.all()\n    context = {\n        'leads':leads,\n    }\n    return render(request,\"leads/lead_list.html\",context)\n")),(0,r.kt)("p",{parentName:"li"},"\u5f15\u7528ListView"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},'class LeadVistView(ListView):\n    template_name = "leads/lead_list.html"\n    queryset = Lead.objects.all()\n'))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("h5",{parentName:"li",id:"\u4fee\u6539\u5728appurls\u4e2d\u5f15\u7528\u7684\u6a21\u7d44\u53ca\u8def\u5f91"},"\u4fee\u6539\u5728app/urls\u4e2d\u5f15\u7528\u7684\u6a21\u7d44\u53ca\u8def\u5f91"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},"from .views import (\n    ..\n    LeadVistView\n)\nurlpatterns = [\n..   path('',LeadVistView.as_view(),name='lead-list'),\n..  \n]\n"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("h5",{parentName:"li",id:"\u4fee\u6b63html\u4e2d\u7684\u53c3\u6578"},"\u4fee\u6b63html\u4e2d\u7684\u53c3\u6578"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"\u56e0\u70ba\u539f\u5148\u7684function\u662f\u81ea\u8a02context\u5167\u5bb9\u518d\u50b3\u53bbhtml\u4e2d\uff0c\u50cf\u9019\u6a23\uff1a")))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"def lead_list(request):\n    ...\n    context = {\n        'leads':leads,\n    }\n    return render(request,\"leads/lead_list.html\",context)\n")),(0,r.kt)("p",null,"   \u56e0\u6b64\uff0c\u6211\u5011\u5728html\u4e2d\u662f\u4ee5",(0,r.kt)("inlineCode",{parentName:"p"},"leads"),"\u4f86\u53d6\u7528\u5167\u5bb9\uff0c\u800c\u4f7f\u7528ListView\u6642\uff0c\u9810\u8a2d\u7684\u540d\u7a31\u662f",(0,r.kt)("inlineCode",{parentName:"p"},"object_list"),"\uff0c\u6240\u4ee5\u628a\u9019\u90e8\u5206\u6539\u6389\u5c31\u884c\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-django"},"{% for lead in leads %}\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-django"},"{% for lead in object_list %}\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u200b\t\u6216\u8005\u8a2d\u5b9a",(0,r.kt)("inlineCode",{parentName:"p"},"context_object_name"),"\uff0c\u5c31\u4e0d\u7528\u66f4\u6539html\u6a94\u6848"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},'class XXX(ListView):\n    ...\n    context_object_name = "leads"\n')))),(0,r.kt)("h4",{id:"detail\u9801\u9762---detailview"},"Detail\u9801\u9762 - ",(0,r.kt)("inlineCode",{parentName:"h4"},"DetailView")),(0,r.kt)("p",null,"e.g.lead_detail"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"template_name")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"queryset")),(0,r.kt)("p",null,"\u5927\u81f4\u4e0a\u8207List\u76f8\u540c\uff0c\u50c5\u6ce8\u610f\u5728",(0,r.kt)("inlineCode",{parentName:"p"},"queryset"),"\u4e5f\u662f\u4f7f\u7528\u4e00\u6a23\u7684",(0,r.kt)("inlineCode",{parentName:"p"},"Lead.objects.all()"),"\u800c\u4e0d\u9700\u8981\u50cf\u539f\u672cfunction\u4e2d\u8a2d\u5b9a\u7528",(0,r.kt)("inlineCode",{parentName:"p"},".get(id=pk)")),(0,r.kt)("h4",{id:"create\u9801\u9762---createview"},"Create\u9801\u9762 - ",(0,r.kt)("inlineCode",{parentName:"h4"},"CreateView")),(0,r.kt)("p",null,"e.g.lead_create"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"template_name")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"form_class"),":\u9023\u7d50\u8868\u55ae\u7684\u90e8\u5206\u3002"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"reverse"),":\u91cd\u65b0\u5c0e\u56de\u67d0\u9801\u9762\u3002"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("h5",{parentName:"li",id:"\u4fee\u6539viewspy\u7684func--class-based-2"},"\u4fee\u6539views.py\u7684func => class based"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"form_class"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},"Class XXX(CreateView):\n    form_class = LeadModelForm\n"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"import reverse from django.shortcuts"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},"from django.shortcuts import reverse\n"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"reverse()"),"\u5167\u662f",(0,r.kt)("inlineCode",{parentName:"p"},"namespace"),"(leads) + ",(0,r.kt)("inlineCode",{parentName:"p"},"path (name)"),"(lead-list)"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},'    def get_success_url(self):\n        return reverse("leads:lead-list")\n'))))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("h5",{parentName:"li",id:"\u4fee\u6539urlspy\u7684path"},"\u4fee\u6539urls.py\u7684path"))),(0,r.kt)("h4",{id:"update\u9801\u9762---updateview"},"Update\u9801\u9762 - ",(0,r.kt)("inlineCode",{parentName:"h4"},"UpdateView")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"template_name")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"form_class")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"queryset")),(0,r.kt)("p",null,"\u9700\u8981\u64cd\u4f5c\u8868\u55ae\u548c\u8cc7\u6599\u5eab\uff0c\u6240\u4ee5\u7528\u5230"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"form_class"),"\u53ca",(0,r.kt)("inlineCode",{parentName:"p"},"queryset"),"\uff0c"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},'class LeadUpdateView(UpdateView):\n    template_name = "leads/lead_update.html"\n    queryset = Lead.objects.all()\n    form_class = LeadModelForm\n    \n    def get_success_url(self):\n        return reverse("leads:lead-list")\n')),(0,r.kt)("h4",{id:"delete\u9801\u9762---deleteview"},"Delete\u9801\u9762 - ",(0,r.kt)("inlineCode",{parentName:"h4"},"DeleteView")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"template_name")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"queryset")),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("h5",{parentName:"li",id:"viewspy\u7684class"},"views.py\u7684class"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},'class LeadDeleteView(DeleteView):\n    template_name = "leads/lead_delete.html"\n    queryset = Lead.objects.all()\n    \n    def get_success_url(self):\n        return reverse("leads:lead-list")\n'))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("h5",{parentName:"li",id:"templatesapphtml"},"templates/app/.html"),(0,r.kt)("p",{parentName:"li"},"\u56e0\u70ba\u5fc5\u9808\u8981\u6709",(0,r.kt)("inlineCode",{parentName:"p"},"template_name"),"\uff0c\u6240\u4ee5\u6211\u5011\u8981\u65b0\u5efa\u4e00\u500blead_delete.html\u3002\t"),(0,r.kt)("p",{parentName:"li"},"\u9019\u88e1\u6211\u5011\u540c\u6a23\u4fdd\u7559form tag\uff0c\u56e0\u70ba\u5728DeleteView\u5c31\u662f\u9810\u8a2d\u8981\u6709\u63d0\u4ea4\u7684\u529f\u80fd\u4f86\u78ba\u5b9a\u8981\u522a\u9664\u3002"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-django"},'{% comment %} app/templates/app/.html {% endcomment %}\n{% extends "base.html" %}\n{% block content %}\n    <a href="{% url \'leads:lead-list\' %}">Go back to leads</a>\n    <hr/>\n    <h1>Are you sure you want to delete this lead</h1>\n    <form method="post">\n        {% csrf_token %}\n        {{form.as_p}}\n        <button>submit</button>\n    </form>\n{% endblock content %}\n')))),(0,r.kt)("h2",{id:"set-static-files"},"Set Static files"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u5728\u6700\u5916\u5c64\u5275\u5efa\u8cc7\u6599\u593estatic\u4e26\u5275\u5efa\u8cc7\u6599\u593e","<","js",">","\u3001","<","css",">","\u3001","<","images",">","\u4f86\u5b58\u653e\u4ee5\u5f8c\u8981\u7528\u7684\u6a94\u6848")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u5728project\u4e2d\u7684settings.py\u53ef\u4ee5\u770b\u5230\u672c\u4f86\u5c31\u6709",(0,r.kt)("inlineCode",{parentName:"p"},"STATIC_URL = '/static/'"),"\uff0c\u6211\u5011\u53e6\u5916\u518d\u8a2d\u5b9a\u4e0b\u9762\u5169\u500b\u8b8a\u6578"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},'STATICFILES_DIRS=[\n    BASE_DIR/"static" #\u50cf\u5728template\u7684\u8a2d\u5b9a\n]\nSTATIC_ROOT="static_root"\n'))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u5728project/urls.py\u8a2d\u5b9a"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"from django.conf import settings"),"\u8b93\u6211\u5011\u53ef\u4ee5\u4f7f\u7528\u7b2c\u4e8c\u9edesetting\u4e2d\u7684",(0,r.kt)("inlineCode",{parentName:"p"},"STATIC_URL"),"\u548c",(0,r.kt)("inlineCode",{parentName:"p"},"STATIC_ROOT"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"from django.conf.urls.static import static"),"\u8b93\u6211\u5011\u53ef\u4ee5\u8a2d\u5b9a"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},"static('settins.STATIC_URL',document_root=settings.STATIC_ROOT)\n")),(0,r.kt)("p",{parentName:"li"},"\u6211\u5011\u5c07\u9019\u4e00\u6bb5\u52a0\u5728\u5e95\u4e0b\uff0c\u800c\u4e0d\u662f\u76f4\u63a5\u653e\u5728URLPattern\u4e2d\uff0c\u56e0\u70ba\u7576\u90e8\u7f72\u6642\uff0cserver\u53ef\u80fd\u6703\u5c07STATIC\u79fb\u81f3\u4e0d\u540c\u4f4d\u7f6e\uff0c\u4e0d\u50cf\u73fe\u5728\u5728\u672c\u5730\u958b\u767c\u7684\u72c0\u614b\uff0c\u6240\u4ee5\u4e0d\u7e3d\u662f\u57f7\u884c\u4ed6\u3002"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},"if settings.DEBUG:\n    urlpatterns += static('settins.STATIC_URL',document_root=settings.STATIC_ROOT)\n"))))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u5728base.html\u4e2d\u4f7f\u7528"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-django"},'{% load static %}\n<!DOCTYPE html>\n<html lang="en">\n<head>\n    ...\n    <link href="{% static \'css/styles.css\' %}" rel="stylesheet"/>\n    ...\n</head>\n<body>\n    ...\n    <script src="{% static \'js/main.js\' %}"/>\n</body>\n</html> \n')))),(0,r.kt)("h2",{id:"send-emails"},"Send Emails"),(0,r.kt)("p",null,"\u73fe\u5728\u6211\u5011\u60f3\u8981\u5728\u300c\u65b0\u589e\u73a9Lead\u6642\uff0c\u5bc4\u767cemail\u300d\u3002\u56e0\u6b64\u6211\u5011\u5728app/views.py\u5b9a\u7fa9class  LeadCreateView\u5b9a\u7fa9\u65b0\u51fd\u6578\u3002"),(0,r.kt)("p",null,"\u8a3b\uff1a\u6211\u5011\u53ef\u4ee5\u9078\u53d6\u5f15\u7528\u7684\u6a21\u7d44\u6309\u53f3\u9375:go to defination \u53bb\u67e5\u770b\u539f\u59cb\u7684\u5b9a\u7fa9\u3002"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u91cd\u65b0\u5b9a\u7fa9",(0,r.kt)("inlineCode",{parentName:"p"},"form_valid"),"\u4e4b\u5f8c\u8981\u57f7\u884c\u7684\u4e8b"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},"#app/views.py\nclass LeadCreateView(CreateView):\n   ...\n    def form_valid(self,form):\n        return super(LeadCreateView,self).form_valid(form)\n"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u5f15\u5165",(0,r.kt)("inlineCode",{parentName:"p"},"send_email")),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},'#app/views.py\nfrom django.core.mail import send_mail\ndef form_valid(self,form):\n        #TO SEND EMAIL\n        send_mail(\n            subject="A lead has been created",\n            message="Go to the site to see the new lead",\n            from_email="test@test.com",\n            recipient_list=["test2@test.com"]\n        )\n        return super(LeadCreateView,self).form_valid(form)\n'))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u5728project\u4e2dsettings.py\u8a2d\u5b9a"),(0,r.kt)("p",{parentName:"li"},"\u544a\u8a34django\u5982\u4f55 send email"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},'#project/settings.py\nEMAIL_BACKEND = "django.core.mail.backends.console.EmailBackend"\n#in real , we use smtp instead of console\n')))),(0,r.kt)("p",null,"\u6700\u5f8c\u5c31\u53ef\u5f97\u5230"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'Content-Type: text/plain; charset="utf-8"\nMIME-Version: 1.0\nContent-Transfer-Encoding: 7bit\nSubject: A lead has been created\nFrom: test@test.com\nTo: test2@test.com\nDate: Fri, 25 Feb 2022 06:24:40 -0000\nMessage-ID: <164577028083.2132.15977409263506702204@yehs1225-VirtualBox>\n\nGo to the site to see the new lead\n')),(0,r.kt)("h2",{id:"authentication"},"Authentication"),(0,r.kt)("p",null,"*\u4f7f\u7528miniconda\u4f86\u5efa\u7acb\u74b0\u5883\u3002"),(0,r.kt)("p",null,"\u53ef\u4ee5\u5728minconda3/python3.9/site-packages/django/contrib/auth/auth/views.py\u4e2d\u67e5\u770b\u5b9a\u7fa9\u597d\u7684\u76f8\u95dc\u6a21\u7d44\uff0c\u88e1\u9762\u6709Login\u3001Logout\u3001Password\u76f8\u95dcview\u3002"),(0,r.kt)("h4",{id:"loginlogout"},"Login/Logout"),(0,r.kt)("p",null,"\u5176\u4e2d\u6211\u5011\u8981\u4f7f\u7528\u7684\u662f",(0,r.kt)("inlineCode",{parentName:"p"},"class LoginView()"),"\u3001",(0,r.kt)("inlineCode",{parentName:"p"},"class LogoutView()"),"\uff0c\u5728",(0,r.kt)("inlineCode",{parentName:"p"},"template_name "),"\u4e2d\u6703\u7528\u5230'registration/login.html'\uff0c\u6240\u4ee5\u6211\u5011\u56de\u5230\u6700\u5916\u5c64\u7684templates\u4e2d\u65b0\u5efa\u8cc7\u6599\u593e\u548c\u6a94\u6848\u3002"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"templates/registration/login.html"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-django"},'#templates/registration/login.html\n{% extends \'base.html\' %}\n{% block content %}\n\n<form method="POST">\n    {% csrf_token %}\n    {{ form.as_p }}\n    <button type="submit">Login</button>\n</form>\n\n{% endblock content %}\n'))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"project/urls.py"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},"from django.contrib.auth.views import LoginView\nurlpatterns = [\n...    path('',LoginView.as_view(),name='login'),   \n]\n"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"project/settings.py"),(0,r.kt)("p",{parentName:"li"},"\u56e0\u70ba\u9810\u8a2d\u5b8c\u767b\u5165\u5f8c\u6703\u5c0e\u56de\u7279\u5b9a\u7684url\uff0c\u4f46\u6211\u5011\u6c92\u6709\u8981\u65b0\u589e\u4e00\u500b\u6a94\u6848\uff0c\u53ea\u662f\u5e0c\u671b\u56de\u5230\u672c\u4f86app\u7684\u9996\u9801\uff0c\u6240\u4ee5\u53ef\u5728settings\u4e2d\u8a2d\u5b9a"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},'LOGIN_REDIRECT_URL="/leads"\n'))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u8a2d\u5b9anavbar\u7684\u767b\u5165\u72c0\u614b\u986f\u793a"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"{% if request.user.is_authenticated %} "),"\u3001",(0,r.kt)("inlineCode",{parentName:"li"},"{% else %}"),"\u548c",(0,r.kt)("inlineCode",{parentName:"li"},"{% endif %}")),(0,r.kt)("li",{parentName:"ul"},"<","a ",">"," Login\u7684href\u4e5f\u8981\u8a18\u5f97\u66f4\u6539")),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-django"},'{% if not request.user.is_authenticated %}\n   <a class="mr-5 hover:text-gray-900">Sign up</a>\n{% endif %}    \n{% if request.user.is_authenticated %}\n   You are logged in: {{request.user.username}}\n{% else %}\n   <a href="{% url \'login\' %}" class="inline-flex items-center bg-gray-100 border-0 py-1 px-3 focus:outline-none hover:bg-gray-200 rounded text-base mt-4 md:mt-0">\n        Login\n      <svg fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="w-4 h-4 ml-1" viewBox="0 0 24 24">\n        <path d="M5 12h14M12 5l7 7-7 7"></path>\n      </svg>\n   </a>\n{% endif %}\n')))),(0,r.kt)("h4",{id:"sign-up"},"Sign up"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"app/forms.py"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},"from django.contrib.auth import get_user_model\nfrom django.contrib.auth.forms import UserCreationForm,UsernameField\nclass CustomUserCreationForm(UserCreationForm):\n    class Meta:\n        model = User\n        fields =(\"username\",)\n        field_classes = {'username':UsernameField}\n")),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"class Meta"),"\u8b93\u4f60\u53ef\u5728model\u5167\u7528metadata\uff08\u6307\u7684\u662f\u4efb\u4f55\u975emodel\u4e2d\u73fe\u5b58\u7684\u6b04\u4f4d\uff09")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"app/views.py"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},'from .forms import ...,CustomUserCreationForm\nclass SignupView(CreateView):\n    template_name = "registration/signup.html"\n    form_class = UserCreationForm\n    \n    def get_success_url(self):\n        return reverse("login")   \n'))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"template/registration/signup.html"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-django"},'{% extends \'base.html\' %}\n{% block content %}\n\n<form method="POST">\n    {% csrf_token %}\n    {{ form.as_p }}\n    <button type="submit">SignUp</button>\n</form>\n\n{% endblock content %}\n'))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"app/urls.py"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},"urlpatterns = [\n... path('signup/',SignupView.as_view(),name='signup'),  \n...\n]\n")))),(0,r.kt)("h2",{id:"test"},"Test"),(0,r.kt)("h4",{id:"1-just-in-apptestpy"},"1. Just In app/test.py"),(0,r.kt)("p",null,"\u6211\u5011\u53ef\u4ee5\u5728app\u8cc7\u6599\u593e\u4e2d\u627e\u5230test.py\u4e26\u5728\u5176\u4e2d\u64b0\u5bebClass \u548c function \uff0c\u4ee5",(0,r.kt)("inlineCode",{parentName:"p"},"$python manage.py test"),"\u4f86\u6e2c\u8a66\u3002"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"class LandingPageTest \u6e2c\u8a66views.py\u4e2d\u7684Landing page"),(0,r.kt)("li",{parentName:"ul"},"function\u4ee5",(0,r.kt)("inlineCode",{parentName:"li"},"test_"),"\u4f5c\u70ba\u958b\u982d\uff0c\u88ab\u8996\u70ba\u4e00\u500btest"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"(self)"),"\u63d0\u4f9b\u8a31\u591afunction\u53ef\u7528\u4f86\u6e2c\u8a66"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"self.client"),"\u5c31\u50cf",(0,r.kt)("inlineCode",{parentName:"li"},"request"),"\u4e00\u6a23\u53ef\u4ee5\u7528",(0,r.kt)("inlineCode",{parentName:"li"},".get"),"\u3001",(0,r.kt)("inlineCode",{parentName:"li"},".post"),"\u7b49\u7b49http \u8acb\u6c42\u65b9\u6cd5"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"reverse"),"\u7528\u4f86\u9023\u5230url"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"self.assertEqual"),"\u6aa2\u67e5\u5169\u7269\u4ef6\u662f\u5426\u76f8\u7b49"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"self.assertTemplateUsed"),"\u6aa2\u67e5response\u662f\u5426\u662f\u60f3\u8981\u7684\u6a94\u6848")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},'from django.test import TestCase\nfrom django.shortcuts import reverse\n\nclass LandingPageTest(TestCase):\n    \n    def test_get(self):\n        response = self.client.get(reverse("landing-page"))\n        # TO test status code\n        self.assertEqual(response.status_code,200)\n        # TO test template code\n        self.assertTemplateUsed(response,"landing.html")\n')),(0,r.kt)("h4",{id:"2-make-a-folder--test"},"2. Make a folder : test"),(0,r.kt)("p",null,"\u56e0\u70ba\u4e4b\u5f8c\u5c08\u6848\u53ef\u80fd\u6703\u8b8a\u5f88\u5927\uff0c\u6240\u4ee5\u4e00\u500b\u597d\u7684\u505a\u6cd5\u53ef\u4ee5\u5728app\u5e95\u4e0b\u65b0\u589e\u8cc7\u6599\u593etests\uff0c\u88e1\u9762\u5148\u65b0\u589e\u4e00\u500b",(0,r.kt)("inlineCode",{parentName:"p"},"__init__.py"),"\uff0c\u5728\u50cf\u4e0a\u9762\u4e00\u6a23\u5efa\u7acb\u60f3\u8981\u7684",(0,r.kt)("inlineCode",{parentName:"p"},"test.py"),"\uff0c\u547d\u540d\u65b9\u5f0f\u53ef\u4ee5\u662f",(0,r.kt)("inlineCode",{parentName:"p"},"test_views.py"),"\u3001",(0,r.kt)("inlineCode",{parentName:"p"},"test_forms.py"),"\u7b49\u3002"),(0,r.kt)("h2",{id:"auth-permissions"},"Auth Permissions"),(0,r.kt)("h4",{id:"\u9019\u4e0d\u662f\u8ab0\u90fd\u53ef\u4ee5\u770b\u7684"},"\u9019\u4e0d\u662f\u8ab0\u90fd\u53ef\u4ee5\u770b\u7684\ud83d\udca2"),(0,r.kt)("p",null,"\u6709\u4e9bviews\u6211\u5011\u5e0c\u671b\u5728\u6709\u6b0a\u9650\u7684\u4eba\u767b\u9304\u5f8c\u624d\u53ef\u4ee5\u770b\u5230\u3002\u6211\u5011\u9700\u8981"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"from django.contrib.auth.mixins import LoginRequiredMixin\n")),(0,r.kt)("p",null,"\u4e26\u4e14\u5c07",(0,r.kt)("inlineCode",{parentName:"p"},"LoginRequiredMixin"),"\u653e\u5728class\uff08\uff09\u7b2c\u4e00\u500b\u4f4d\u7f6e\u50cf\u9019\u6a23"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"class LeadVistView(LoginRequiredMixin,ListView):\n    ...\n")),(0,r.kt)("p",null,"\u63a5\u8005\u5728\u700f\u89bd\u5668\u7684\u7db2\u5740\u5217\u53ef\u770b\u5230"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"http://localhost:8000/accounts/login/?next=/leads/\n")),(0,r.kt)("p",null,"\u6703\u5148\u5c0e\u5230\u767b\u5165\u9801\u9762\uff0c\u5728redirect\u5230\u539f\u672c\u8981\u53bb\u7684\u9801\u9762\uff0c\u5176\u4e2d\u767b\u5165\u9801\u9762\u9810\u8a2d\u70ba",(0,r.kt)("inlineCode",{parentName:"p"},"accounts/login"),"\uff0c\u4f46\u6211\u5011\u7684app\u4e2d\u662f\u8a2d\u5b9a",(0,r.kt)("inlineCode",{parentName:"p"},"login"),"\uff0c\u6240\u4ee5\u53bbproject\u4e2dsettings.py\u8a2d\u5b9a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"LOGIN_URL = '/login'\n")),(0,r.kt)("h4",{id:"\u4f60\u7684\u5c08\u5c6c\u5167\u5bb9"},"\u4f60\u7684\u5c08\u5c6c\u5167\u5bb9"),(0,r.kt)("p",null,"\u6211\u5011\u73fe\u5728\u67093\u500bmodels:User, Lead, Agent\uff0c\u5e0c\u671b\u505a\u5230\u7684\u529f\u80fd\u662f\u4f7f\u7528\u8005\u767b\u5165\u5f8c\uff0c\u5c6c\u65bc\u8a72User\u7684Lead\u548cAgent\u53ef\u4ee5\u5448\u73fe\u53ca\u7ba1\u7406\uff0c\u56e0\u6b64\u6211\u5011\u65b0\u589e\u4e00\u500bmodel\u53eb\u505aUserProfile\uff0c\u4e26\u4e14\u4e5f\u4fee\u6539Agent\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},'class UserProfile(models.Model):\n    user = models.OneToOneField("User",on_delete=models.CASCADE)\n\n    def __str__(self):\n        return self.user.username\n\nclass Agent(models.Model):\n    user = models.OneToOneField("User",on_delete=models.CASCADE)\n    organization = models.ForeignKey(UserProfile,on_delete=models.CASCADE)\n    def __str__(self):\n        return self.user.email    \n')),(0,r.kt)("p",null,"\u65b0\u589e\u5b8c\u65b0model\u8981\u8a18\u5f97\u53bbadmin.py\u8a3b\u518a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"from .models import ...,UserProfile\nadmin.site.register(UserProfile)\n")),(0,r.kt)("h4",{id:"signal"},"Signal"),(0,r.kt)("p",null,"\u53ef\u4ee5\u505a\u8a2d\u5b9a\uff0c\u8b93\u767c\u751f\u7279\u5b9a\u4e8b\u60c5\u6642django\u6703\u767c\u9001signal\u3002"),(0,r.kt)("p",null,"\u76ee\u524d\u60f3\u505a\u7684\u662f\uff1a\u7576\u6709\u65b0user\u88ab\u5efa\u7acb\u6642\uff0c\u5c31\u65b0\u5efa\u4e00\u7b46UserProfile\u8cc7\u6599\u3002"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"\u5f15\u5165\u6a21\u7d44\uff1a")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"from django.db.models.signals import post_save\n")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"post_save")," :\u7576POST\u8acb\u6c42\u88ab\u6210\u529f\u5132\u5b58\u5728model\u6642\uff08\u53e6\u5916\u4e5f\u6709",(0,r.kt)("inlineCode",{parentName:"p"},"pre_save"),"\uff0c\u4f5c\u7528\u65bc\u5c1a\u672a\u88ab\u5b58\u5230\u8cc7\u6599\u5eab\u6642\uff09"),(0,r.kt)("ol",{start:2},(0,r.kt)("li",{parentName:"ol"},"\u5b9a\u7fa9function\uff1a")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"# a signal once the post_save is set\ndef post_user_created_signal(sender,instance, created, **kwargs):\n    if created:\n        UserProfile.objects.create(user=instance)\n\npost_save.connect(post_user_created_signal,sender=User)\n")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"post_save.connect(arg1,arg2)"),"\uff1a"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"arg1 : \u8981\u547c\u53eb\u7684function"),(0,r.kt)("li",{parentName:"ul"},"arg2 : \u8981\u9023\u63a5\u7684model")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"def post_user_created_signal(sender,instance, created, **kwargs)")," :"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"sender : signal\u9023\u63a5\u7684model"),(0,r.kt)("li",{parentName:"ul"},"instance : \u767c\u51fa\u8a0a\u865f\u7684\u7269\u4ef6\uff0c\u4f8b\u5982\u9019\u88e1\u662f\u66f4\u6539\u4f7f\u7528\u8005test1\u7684\u8cc7\u6599\uff0cprint\u51fa\u4f86\u5c31\u662ftest1"),(0,r.kt)("li",{parentName:"ul"},"created : \u7528\u4f86\u5075\u6e2c\u9019\u6b21\u7684signal\u662f\u5426\u662f\u5168\u65b0\u7684post\u6216\u53ea\u662f\u4fee\u6539"),(0,r.kt)("li",{parentName:"ul"},"**kwargs : \u63a5\u6536\u5269\u9918\u6240\u6709arguments")),(0,r.kt)("h4",{id:"user-types"},"User Types"),(0,r.kt)("p",null,"\u5c07user\u5206\u70ba\u5169\u985e\uff1a\u7d44\u7e54\u7ba1\u7406\u8005\uff08organizor\uff09\u53ca\u55ae\u4e00\u6a5f\u69cb\uff08agent\uff09\u3002\u65bc\u662f\u56de\u5230\u539f\u5148\u5efa\u7acb\u7684model User\u589e\u52a0\u65b0\u6b04\u4f4d",(0,r.kt)("inlineCode",{parentName:"p"},"is_organizer"),"\u53ca",(0,r.kt)("inlineCode",{parentName:"p"},"is_agent"),"\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"class User(AbstractUser):\n    is_organizor = models.BooleanField(default=True)\n    is_agent = models.BooleanField(default=False)\n")),(0,r.kt)("p",null,"\u4e4b\u5f8c\u6211\u5011\u53ef\u4ee5\u5728navbar\u4e2d\u904e\u6ffe\u662f\u5426\u70baorganizor"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-html"},'{% if request.user.is_organizor %}\n    <a href="{% url \'agents:agent-list\' %}" class="mr-5 hover:text-gray-900">Agents</a>\n{% endif %}\n')),(0,r.kt)("p",null,"\u7136\u800c\u9019\u6a23\u53ea\u662f\u4e0d\u986f\u793a\u5728\u6e32\u67d3\u7684\u756b\u9762\u4e0a\uff0c\u5be6\u969b\u4e0a\u4ecd\u53ef\u900f\u904e\u5728\u7db2\u5740\u4e0a\u76f4\u63a5\u8f38\u5165\u4f86\u5b58\u53d6\u6307\u5b9a\u9801\u9762\uff0c\u56e0\u6b64\u61c9\u8a72\u5728views.py\u53bb\u505a\u9650\u5236\u3002"),(0,r.kt)("h4",{id:"\u5ba2\u88fd\u5316\u7684mixin"},"\u5ba2\u88fd\u5316\u7684Mixin"),(0,r.kt)("p",null,"\u5728\u524d\u9762\u8a2d\u5b9aview\u6642\u6211\u5011\u66fe\u7d93\u7528\u904e"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"from django.contrib.auth.mixins import LoginRequiredMixin\nclass LeadVistView(LoginRequiredMixin,ListView):\n    ...\n")),(0,r.kt)("p",null,"\u4f86\u78ba\u8a8d\u4f7f\u7528\u8005\u662f\u5426\u5df2\u767b\u5165\uff0c\u4f46\u662f\u73fe\u5728\u4e0d\u53ea\u662f\u4f7f\u7528\u8005\u767b\u5165\uff0c\u9084\u8981\u6aa2\u67e5\u4ed6\u662f\u5426\u70baorganizer\uff0c\u56e0\u6b64\u6211\u5011\u53bb\u5bdf\u770b\u6b64\u6a21\u7d44\u5f8c"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},'class LoginRequiredMixin(AccessMixin):\n    """Verify that the current user is authenticated."""\n    def dispatch(self, request, *args, **kwargs):\n        if not request.user.is_authenticated:\n            return self.handle_no_permission()\n        return super().dispatch(request, *args, **kwargs)\n')),(0,r.kt)("p",null,"\u53ef\u4ee5\u7528",(0,r.kt)("inlineCode",{parentName:"p"},"AccessMixin"),"\u4f86\u5ba2\u88fd\u5316\u81ea\u5df1\u7684mixin\u3002"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u65b0\u589emixins.py"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},'from django.contrib.auth.mixins import AccessMixin\nfrom django.shortcuts import redirect\n\nclass OrganizorAndLoginRequiredMixin(AccessMixin):\n    """Verify that the current user is authenticated and is organizor."""\n    def dispatch(self, request, *args, **kwargs):\n        if not request.user.is_authenticated or not request.user.is_organizor:\n            return redirect("leads:lead-list")\n        return super().dispatch(request, *args, **kwargs)    \n')),(0,r.kt)("p",{parentName:"li"},"\u9664\u4e86\u5728if\u5224\u65b7\u4e2d\u52a0\u5165"),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"or not request.user.is_organizor")),(0,r.kt)("p",{parentName:"li"},"\u7531\u65bc return \u539f\u5148\u7684",(0,r.kt)("inlineCode",{parentName:"p"},"self.handle_no_permission()"),"\u662f\u6703\u4e1f\u51faerror code\uff08403 Forbidden\uff09\uff0c\u6211\u5011\u53ef\u4ee5\u628a\u5b83\u6539\u6210redirect\u5230\u6307\u5b9a\u9801\u9762\u3002")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u5728views.py\u4e2d\u5f15\u7528"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},'#agents.views.py\nfrom .mixins import OrganizorAndLoginRequiredMixin\n\nclass AgentListView(OrganizorAndLoginRequiredMixin,generic.ListView):\n    template_name = "agents/agent_list.html"\n    context_object_name = "agents"\n    def get_queryset(self):\n        return Agent.objects.all()\n')))),(0,r.kt)("h2",{id:"password"},"Password"),(0,r.kt)("h4",{id:"set-random-password"},"set random password"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},'user.set_password(f"{random.randint(0,100000)}")\n')),(0,r.kt)("h4",{id:"reset-password"},"reset password"),(0,r.kt)("p",null,"\u5728auth.views\u4e2d\u6709\u63d0\u4f9b\u91cd\u8a2d\u5bc6\u78bc\u7684view\uff08\u5982\u540clogin/logout\uff09\uff0c\u56e0\u6b64\u6211\u5011\u5728project\u7684urls.py\u4e2d\u5f15\u7528\uff0c1\u4e26\u5728url\u4e2d\u52a0\u5165\u8def\u5f91\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"from django.contrib.auth.views import(\n    PasswordResetView,\n    PasswordResetDoneView,\n    PasswordResetConfirmView\n)\n\nurlpatterns = [\n    ...\n    path('password-reset/',PasswordResetView.as_view(),name='password-reset'),   \n    path('password-reset-confirm/<uidb64>/<token>',PasswordResetConfirmView.as_view(),name='password-reset-confirm'),   \n    path('password-reset-done/',PasswordResetDoneView.as_view(),name='password-reset-confirm'),   \n]\n")),(0,r.kt)("p",null,"\u5728\u5f15\u7528\u5f8c\u53bb\u67e5\u770b\u9019\u5e7e\u500bvieew\u53ef\u4ee5\u770b\u5230\u4ed6\u5011\u5206\u5225\u6703\u5c0d\u61c9\u9700\u8981\u7684.html\u6a94\u6848"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"PasswordResetView"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"password_reset_form.html"),(0,r.kt)("p",{parentName:"li"},"\u6309forget password\u5f8c\u6703\u5148\u9023\u5230\u9019\u88e1"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},'{% extends \'base.html\' %}\n{% block content %}\n\n<form method="POST">\n    {% csrf_token %}\n    {{ form.as_p }}\n    <button type="submit">Reset password</button>\n</form>\n<hr>\n<a href="{% url \'login\'%}">Already have an account?</a>\n\n{% endblock content %}\n'))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"password_reset_email.html"),(0,r.kt)("p",{parentName:"li"},"\u4e0b\u65b9\u9019\u500blink\u7684\u5448\u73fe\u65b9\u5f0f\u4e0d\u662f\u6700\u4f73\u7684\uff0cdjango\u6709\u63d0\u4f9b\u76f8\u95dcpackage\u53ef\u4f7f\u7528\u3002"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-django"},"You've requested to reset your password.\n\nPlease click the following link to enter your new password :\n\n{{ protocol }}://{{ domain }}/password-reset-confirm/{{uid}}/{{token}}\n")))))),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"PasswordResetConfirmView"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"password_reset_confirm.html"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-django"},'{% extends \'base.html\' %}\n{% block content %}\n\n<form method="POST">\n    {% csrf_token %}\n    {{ form.as_p }}\n    <button type="submit">Reset password</button>\n</form>\n<hr>\n<a href="{% url \'login\'%}">Already have an account?</a>\n\n{% endblock content %}\n')))))),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"PasswordResetDoneView"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"password_reset_done.html"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-django"},'{% extends "base.html" %}\n\n{% block content %}\n    <h1>We\'ve sent a email to reset the password</h1>\n{% endblock content %}\n'))))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"PasswordResetCompleteView"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"password_reset_complete.html"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-django"},"{% extends 'base.html' %}\n{% block content %}\n\n<h1>Password reset completed</h1>\n<hr>\n<p>Click <a href=\"{% url 'login'%}\">here</a> to login</p>\n\n\n{% endblock content %}\n")))))),(0,r.kt)("h2",{id:"dynamic-choices"},"Dynamic choices"),(0,r.kt)("h4",{id:"pass-arguments-from-views-to-forms"},"Pass arguments from views to forms"),(0,r.kt)("p",null,"views.py"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},'#pass extra arguments into the form\ndef get_form_kwargs(self):\n    return {\n        "request":self.request\n    }\n')),(0,r.kt)("p",null,"forms.py"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"class AssinAgentForm(forms.Form):\n    agent = forms.ModelChoiceField(queryset=Agent.objects.none())\n\n    #get parameter passed in views\n    def __init__(self, *args, **kwargs):\n        print(kwargs)\n#{'request': <WSGIRequest: GET '/leads/1/assign-agent/'>}\n")),(0,r.kt)("h4",{id:"assign-agents-to-lead-agent-in-the-organization"},"Assign agents to lead (agent in the organization)"),(0,r.kt)("p",null,"the choices of agents are generated dynamically according to the organization."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},'#views.py\nclass AssignAgentView(OrganizorAndLoginRequiredMixin,FormView):\n    template_name = "leads/assign_agent.html"\n    form_class = AssinAgentForm\n\n    #pass extra arguments into the form\n    def get_form_kwargs(self,**kwargs):\n        kwargs=super(AssignAgentView,self).get_form_kwargs(**kwargs)\n        kwargs.update({\n            "request":self.request\n        })\n        return kwargs\n\n    def get_success_url(self):\n        return reverse("leads:lead-list")\n\n    def form_valid(self,form):\n        agent = form.cleaned_data[\'agent\']\n        lead = Lead.objects.get(id=self.kwargs["pk"])\n        lead.agent = agent\n        lead.save()\n        return super(AssignAgentView,self).form_valid(form)\n')),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"#forms.py\nclass AssinAgentForm(forms.Form):\n    agent = forms.ModelChoiceField(queryset=Agent.objects.none())\n\n    #get parameter passed in views\n    def __init__(self, *args, **kwargs):\n        request = kwargs.pop('request')\n        agents = Agent.objects.filter(organization=request.user.userprofile)\n        #initialize the form\n        super(AssinAgentForm,self).__init__(*args,**kwargs)\n        self.fields['agent'].queryset = agents\n")),(0,r.kt)("h2",{id:"filter-by-category"},"Filter by category"),(0,r.kt)("p",null,"\u5c07leads\u4f9d\u7167\u985e\u5225\u5206\u985e\u986f\u793a\uff0c\u76ee\u524d\u7684model\u5982\u4e0b"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},'class Lead(models.Model):\n    first_name = models.CharField(max_length=20)\n    last_name = models.CharField(max_length=20)\n    age = models.IntegerField(default=0)\n    organization = models.ForeignKey(UserProfile,on_delete=models.CASCADE)\n    agent = models.ForeignKey("Agent",null=True,blank=True,on_delete = models.SET_NULL)\n    category = models.ForeignKey("Category",null=True,blank=True,on_delete = models.SET_NULL)\n\n#category of leads : New(initial), contacted, Converted, Unconverted\nclass Category(models.Model):\n    name = models.CharField(max_length=30)\n    organization = models.ForeignKey(UserProfile,on_delete=models.CASCADE)   \n')),(0,r.kt)("h4",{id:"\u6709\u4e09\u7a2e\u65b9\u6cd5\u53ef\u4ee5\u5be6\u73fe"},"\u6709\u4e09\u7a2e\u65b9\u6cd5\u53ef\u4ee5\u5be6\u73fe"),(0,r.kt)("p",null,"\u524d\u5169\u7a2e\u57fa\u672c\u4e0a\u662f\u9577\u5f97\u50cf\u9019\u6a23\u5b50\uff0c",(0,r.kt)("inlineCode",{parentName:"p"},"get_context_data(self,**kwargs):"),"\uff0c\u518d\u5c0dcontext\u505a\u4e00\u4e9bupdate"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"class CategoryDetailView(LoginRequiredMixin,DetailView):\n    template_name = 'leads/category_detail.html'\n    context_object_name = 'category'\n\n    def get_context_data(self,**kwargs):\n        context = super(CategoryDetailView,self).get_context_data(**kwargs)   \n        leads = ...\n        context.update({\n            'leads':leads\n        })\n        return context\n\n    def get_queryset(self):\n        user = self.request.user\n        #initial query of lead in the organization\n        if user.is_organizor:\n            queryset = Category.objects.filter(\n                organization = user.userprofile\n            )\n            else:\n                queryset = Category.objects.filter(\n                    organization = user.agent.organization\n                )\n                return queryset\n")),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"get_object")),(0,r.kt)("p",{parentName:"li"},"\u6b64\u65b9\u6cd5\u5728DetailView\u4e2d"),(0,r.kt)("p",{parentName:"li"},"\uff0c\u6703\u56de\u50b3\u9019\u500bview\u6240\u9700\u8981\u7684\u55ae\u4e00\u7269\u4ef6\uff0c\u4f7f\u7528",(0,r.kt)("inlineCode",{parentName:"p"},"queryset"),"\u6216",(0,r.kt)("inlineCode",{parentName:"p"},"get_queryset()"),"\u7576\u4f5c\u7269\u4ef6\u7684\u4f86\u6e90\uff0c\u4f7f\u7528\u7db2\u5740\u5217\u6240\u63d0\u4f9b\u7684\u5f15\u6578\u4f5c\u70ba\u67e5\u627e\u76ee\u6a19\u3002\uff08\u7ffb\u8b6f\u5f97\u5f88\u721b\uff0c\u53ef\u4ee5\u76f4\u63a5\u770b\u6587\u4ef6!\uff09"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},"leads = Lead.objects.filter(category=self.get_object())\n"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u53cd\u5411\u53bb\u641c\u5c0bforiegn key"),(0,r.kt)("p",{parentName:"li"},"\u56e0\u70bamodel Category \u662f model Lead\u7684FK\uff0c\u6240\u4ee5\u53ef\u4ee5\u7528\u9019\u6a23\u7684\u65b9\u6cd5\u3002"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},"leads = self.get_object().lead_set.all()\n")),(0,r.kt)("p",{parentName:"li"},"\u53e6\u5916\u4e5f\u53ef\u4ee5\u5728models.py\u505a\u4e9b\u66f4\u52d5\uff0c\u5728Lead\u4e2d\u7684category\u6b04\u4f4d\u52a0\u5165\u65b0\u7684field ",(0,r.kt)("inlineCode",{parentName:"p"},"related_name"),"\uff08\u9019\u500bname\u7528\u4f86\u544a\u77e5\u9023\u7d50\u5169model\u7684\u95dc\u4fc2\uff09"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},"category = models.ForeignKey(\"Category\",related_name='leads',null=True,blank=True,on_delete = models.SET_NULL)\n")),(0,r.kt)("p",{parentName:"li"},"\u56e0\u6b64\u5728views.py\u5c31\u53ef\u4ee5\u6539\u6210"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},"leads = self.get_object().leads.all()\n"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"\u6709\u4e86",(0,r.kt)("inlineCode",{parentName:"strong"},"related_name"),"\u53ef\u4ee5\u76f4\u63a5\u5728html\u4e2d\u4f7f\u7528")))),(0,r.kt)("p",null,"\u200b\t\t\u524d\u9762\u5169\u7a2e\u65b9\u6cd5\u56e0\u70ba\u5728views.py\u4e2d\u5df2\u7d93\u904e\u6ffe\u597d\u8981\u986f\u793a\u7684lead\uff0c\u6240\u4ee5\u5728html\u4e2d\u662f\u9577\u9019\u6a23\u5b50"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-django"},'{% for lead in leads %}\n    <tr>\n        <td class="px-4 py-3">{{ lead.first_name }}</td>\n        <td class="px-4 py-3">{{ lead.last_name }}</td>\n    </tr>\n{% endfor %}\n')),(0,r.kt)("p",null,"\u200b\t\u800c\u56e0\u70ba\u525b\u525b\u5728model\u4e2d\u8a2d\u5b9a\u4e86",(0,r.kt)("inlineCode",{parentName:"p"},"related_name = leads"),"\uff0c\u6240\u4ee5\u4e0d\u9700\u8981\u5728views\u4e2d\u5148",(0,r.kt)("inlineCode",{parentName:"p"},"get_context_data()"),"\uff0c\u800c\u662f\u76f4\u63a5\u5c07html\u6539\u6210"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-django"},'{% for lead in category.leads.all %}\n    <tr>\n        <td class="px-4 py-3">{{ lead.first_name }}</td>\n        <td class="px-4 py-3">{{ lead.last_name }}</td>\n    </tr>\n{% endfor %}\n')),(0,r.kt)("h2",{id:"django-third-party-packages"},"Django Third party Packages"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://djangopackages.org/"},"https://djangopackages.org/")),(0,r.kt)("p",null,"Use crispy form for this project."),(0,r.kt)("h2",{id:"deployment"},"Deployment"),(0,r.kt)("h3",{id:"environment-variables"},"Environment Variables"),(0,r.kt)("p",null,"\u7528django-environ\u4f86\u7ba1\u7406\u8a2d\u5b9a\u7684\u5957\u4ef6\uff0c\u539f\u5148\u7684\u8a2d\u5b9a\u90fd\u5728project/settings.py\u88e1\u9762\uff0c\u73fe\u5728\u5c07\u8a2d\u5b9a\u62bd\u96e2\u5230\u7a0b\u5f0f\u4e4b\u5916\uff0c\u4ee5\u4fbf\u672a\u4f86\u6709\u8a2d\u5b9a\u9700\u8981\u66f4\u52d5\u6642\u50c5\u9700\u8abf\u6574\u9019\u4e9b\u8a2d\u5b9a\u5c31\u884c\u4e86\u3002"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"$pip install django-environ")),(0,r.kt)("p",{parentName:"li"},"\uff08\u8a18\u5f97\u6bcf\u6b21\u65b0\u589e\u5957\u4ef6\u5c31\u7528",(0,r.kt)("inlineCode",{parentName:"p"},"$pip freeze > requirements.txt"),"\u4f86\u8a18\u9304\uff09")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u65b0\u5efa",(0,r.kt)("inlineCode",{parentName:"p"},".env"),"\u5728project\u7684\u6839\u76ee\u9304\u4e2d"),(0,r.kt)("p",{parentName:"li"},"\u53e6\u5916\u4e5f\u5275\u5efa\u4e00\u500b",(0,r.kt)("inlineCode",{parentName:"p"},".template.env"),"\u4e4b\u5f8c\u6703\u653e\u5728git repository\u4e0a\uff0c\u56e0\u70ba\u6211\u5011\u4e0d\u6703\u60f3\u628asecret_key\u653e\u5728\u7db2\u8def\u4e0a\uff0c\u6240\u4ee5\u53ea\u653e\u6a21\u677f\u3002"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},"DEBUG=True\nSECRET_KEY='XXXXXXX'\n"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"project/settings.py\u65b0\u589e"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},"import environ\nimport os\nenv = environ.Env(\n    # set casting, default value\n    DEBUG=(bool, False)\n)\nenviron.Env.read_env()\nDEBUG = env('DEBUG')\nSECRET_KEY = env('SECRET_KEY')\n\nBASE_DIR = Path(__file__).resolve().parent.parent\n")),(0,r.kt)("p",{parentName:"li"},"\u5176\u4e2d\uff0c\u70ba\u4e86\u8b93\u6211\u5011\u81ea\u5df1\u6c7a\u5b9a\u662f\u5426\u7a0b\u5f0f\u53ef\u4ee5\u8b80\u53d6.env\uff0c\u5c07"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},"environ.Env.read_env()\n")),(0,r.kt)("p",{parentName:"li"},"\u6539\u6210"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},"READ_DOT_ENV_FILE = env.bool('READ_DOT_ENV_FILE',default=False)\nif READ_DOT_ENV_FILE:\n    environ.Env.read_env()\n")),(0,r.kt)("p",{parentName:"li"},"\u7576\u6211\u5011\u5728terminal\u6216\u4f48\u7f72\u6642\u7684\u7d42\u7aef\u6a5f\u8f38\u5165",(0,r.kt)("inlineCode",{parentName:"p"},"export  READ_DOT_ENV_FILE=True"),"\u6642\uff0c\u5c31\u53ef\u4ee5\u53bb\u8b80\u53d6.env\uff0c\u518d\u9032\u4e00\u6b65\u958b\u59cb\u57f7\u884cserver\u3002"))),(0,r.kt)("h3",{id:"set-up-postgresql"},"Set up Postgresql"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u5b89\u88ddPostgreSQL"),(0,r.kt)("p",{parentName:"li"},"Ubuntu\u4e2d\u5b98\u65b9\u5957\u4ef6\u5df2\u6536\u9304\uff0c\u6240\u4ee5\u57f7\u884c\u4ee5\u4e0b\u6307\u4ee4\u5373\u53ef"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"$sudo apt update")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"$apt-get install postgresql-12"),"\uff08\u6700\u65b0\u7248\uff09"),(0,r.kt)("li",{parentName:"ul"},"\u76f8\u95dc\u64cd\u4f5c",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"$systemctl status postgresql.service"),"\u67e5\u770b\u670d\u52d9\u6c23\u662f\u5426\u6b63\u5e38\u555f\u52d5"),(0,r.kt)("li",{parentName:"ul"},"\u9032\u5165\u6307\u4ee4\u4ecb\u9762",(0,r.kt)("inlineCode",{parentName:"li"},"$sudo -u postgres psql"),"\uff08\u4ee5\u9810\u8a2d\u7ba1\u7406\u6b0a\u9650\u4f7f\u7528\u8005postgres\u64cd\u4f5c\uff09"),(0,r.kt)("li",{parentName:"ul"},"\u96e2\u958b",(0,r.kt)("inlineCode",{parentName:"li"},"Ctrl"),"+",(0,r.kt)("inlineCode",{parentName:"li"},"d"),"\u6216",(0,r.kt)("inlineCode",{parentName:"li"},"q")),(0,r.kt)("li",{parentName:"ul"},"\u65b0\u589e\u4f7f\u7528\u8005",(0,r.kt)("inlineCode",{parentName:"li"},"createuser User1")),(0,r.kt)("li",{parentName:"ul"},"\u65b0\u589e\u8cc7\u6599\u5eab",(0,r.kt)("inlineCode",{parentName:"li"},"createdb dbdemo")))))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"DB\u64cd\u4f5c"),(0,r.kt)("ol",{parentName:"li"},(0,r.kt)("li",{parentName:"ol"},"\u5275\u5efa\u8cc7\u6599\u5eab",(0,r.kt)("inlineCode",{parentName:"li"},"CREATE DATABASE yehcrm;")),(0,r.kt)("li",{parentName:"ol"},"\u5275\u5efa\u4f7f\u7528\u8005",(0,r.kt)("inlineCode",{parentName:"li"},"CREATE USER yehcrmuser WITH PASSWORD 'XXXX';")),(0,r.kt)("li",{parentName:"ol"},"\u7d66\u4e88\u6b0a\u9650",(0,r.kt)("inlineCode",{parentName:"li"},"GRANT ALL PRIVILEGES ON DATABASE yehcrm TO yehcrmuser;")))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u66f4\u6539.env \u548c .template.env"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},'DEBUG=True\nSECRET_KEY=\'znogy$=ohkmfq@*0a+75t6!nkhpmto2ecuae)(l6n$%uzmn@tw\'\nDB_NAME="yehcrm" \n# use "" or not is fine\nDB_USER=yehcrmuser\nPASSWORD=yehcrm1225\nDB_HOST=localhost\n\n#leave blank means go defalt\nDB_PORT=\n')),(0,r.kt)("p",{parentName:"li"},"** ",(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("inlineCode",{parentName:"strong"},"="),"\u524d\u5f8c\u5982\u6709\u7a7a\u683c\u53ef\u80fd\u9020\u6210\u8b80\u53d6\u5931\u6557!!!!"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"settings.py\u4e2d\u7684DATABASES"),(0,r.kt)("p",{parentName:"li"},"\u5b89\u88dd\u5957\u4ef6",(0,r.kt)("inlineCode",{parentName:"p"},"psycopg2")," : ",(0,r.kt)("inlineCode",{parentName:"p"},"pip install psycopg2-binary")),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},"DATABASES = {\n    'default': {\n        'ENGINE': 'django.db.backends.postgresql_psycopg2',\n        'NAME': env('DB_NAME'),\n        'USER':env(\"DB_USER\"),\n        'PASSWORD':env(\"PASSWORD\"),\n        'HOST':env(\"DB_HOST\"),\n        'PORT':env(\"DB_PORT\")\n    }\n}\n"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"python manage.py migrate")),(0,r.kt)("p",{parentName:"li"},"\u56e0\u70ba\u63db\u4e86\u8cc7\u6599\u5eab\uff0c\u6240\u4ee5\u9700\u8981\u91cd\u65b0migrate"))),(0,r.kt)("h3",{id:"whitenoise---static-files"},"Whitenoise -> Static files"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"http://whitenoise.evans.io/en/stable/"},"http://whitenoise.evans.io/en/stable/")),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("inlineCode",{parentName:"li"},"$pip install whitenoise")),(0,r.kt)("li",{parentName:"ol"},"\u4fee\u6539settings.py\uff08\u6839\u64da\u6587\u4ef6\uff09"),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("inlineCode",{parentName:"li"},"$python manage.py collectstatic"))),(0,r.kt)("h3",{id:"digital-ocean"},"Digital Ocean"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Add a new app")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Build a DB")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"enter enviroment variable for the app")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"$pip install gunicorn"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"add security in settings.py"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},'if not DEBUG:\n    SECURE_PROXY_SSL_HEADER = (\'HTTP_X_FORWARDED_PROTO\', \'https\')\n    SECURE_SSL_REDIRECT = True\n    SESSION_COOKIE_SECURE = True\n    CSRF_COOKIE_SECURE = True\n    SECURE_BROWSER_XSS_FILTER = True\n    SECURE_CONTENT_TYPE_NOSNIFF = True\n    SECURE_HSTS_SECONDS = 31536000  # 1 year\n    SECURE_HSTS_INCLUDE_SUBDOMAINS = True\n    SECURE_HSTS_PRELOAD = True\n    X_FRAME_OPTIONS = "DENY"\n\n    ALLOWED_HOSTS = ["*"]\n\n    EMAIL_BACKEND = "django.core.mail.backends.smtp.EmailBackend"\n    EMAIL_HOST = env("EMAIL_HOST")\n    EMAIL_HOST_USER = env("EMAIL_HOST_USER")\n    EMAIL_HOST_PASSWORD = env("EMAIL_HOST_PASSWORD")\n    EMAIL_USE_TLS = True\n    EMAIL_PORT = env("EMAIL_PORT")\n    DEFAULT_FROM_EMAIL = env("DEFAULT_FROM_EMAIL")\n'))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"new file runserver.sh"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"python manage.py collectstatic --no-input\n\npython manage.py migrate\n\ngunicorn --worker-tmp-dir /dev/shm djcrm.wsgi\n")),(0,r.kt)("p",{parentName:"li"},"\u4f46\u9019\u4e0d\u80fd\u5728terminal\u4e2d\u57f7\u884c\uff0c\u8f38\u5165",(0,r.kt)("inlineCode",{parentName:"p"},"$chmod +x runserver.sh")))),(0,r.kt)("h3",{id:"mailgun"},"Mailgun"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://www.mailgun.com/"},"Transactional Email API Service For Developers | Mailgun")))}k.isMDXComponent=!0},8289:function(e,t,a){t.Z=a.p+"assets/images/form1-c0a49ebcdc35134021a20e00aba8e66e.jpg"},4885:function(e,t,a){t.Z=a.p+"assets/images/lead_table-ec9b09387babd89bd5bc50b5e7aa26fc.jpg"}}]);