"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[2600],{3905:function(e,a,n){n.d(a,{Zo:function(){return p},kt:function(){return g}});var t=n(7294);function l(e,a,n){return a in e?Object.defineProperty(e,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[a]=n,e}function r(e,a){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);a&&(t=t.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),n.push.apply(n,t)}return n}function i(e){for(var a=1;a<arguments.length;a++){var n=null!=arguments[a]?arguments[a]:{};a%2?r(Object(n),!0).forEach((function(a){l(e,a,n[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))}))}return e}function s(e,a){if(null==e)return{};var n,t,l=function(e,a){if(null==e)return{};var n,t,l={},r=Object.keys(e);for(t=0;t<r.length;t++)n=r[t],a.indexOf(n)>=0||(l[n]=e[n]);return l}(e,a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(t=0;t<r.length;t++)n=r[t],a.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}var o=t.createContext({}),m=function(e){var a=t.useContext(o),n=a;return e&&(n="function"==typeof e?e(a):i(i({},a),e)),n},p=function(e){var a=m(e.components);return t.createElement(o.Provider,{value:a},e.children)},d={inlineCode:"code",wrapper:function(e){var a=e.children;return t.createElement(t.Fragment,{},a)}},c=t.forwardRef((function(e,a){var n=e.components,l=e.mdxType,r=e.originalType,o=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),c=m(n),g=l,u=c["".concat(o,".").concat(g)]||c[g]||d[g]||r;return n?t.createElement(u,i(i({ref:a},p),{},{components:n})):t.createElement(u,i({ref:a},p))}));function g(e,a){var n=arguments,l=a&&a.mdxType;if("string"==typeof e||l){var r=n.length,i=new Array(r);i[0]=c;var s={};for(var o in a)hasOwnProperty.call(a,o)&&(s[o]=a[o]);s.originalType=e,s.mdxType="string"==typeof e?e:l,i[1]=s;for(var m=2;m<r;m++)i[m]=n[m];return t.createElement.apply(null,i)}return t.createElement.apply(null,n)}c.displayName="MDXCreateElement"},5924:function(e,a,n){n.r(a),n.d(a,{frontMatter:function(){return s},contentTitle:function(){return o},metadata:function(){return m},toc:function(){return p},default:function(){return c}});var t=n(7462),l=n(3366),r=(n(7294),n(3905)),i=["components"],s={},o="GetStarted - build CRM [1]",m={unversionedId:"Django/[DJ]GetStartedBuildCRM[2]",id:"Django/[DJ]GetStartedBuildCRM[2]",title:"GetStarted - build CRM [1]",description:"Model",source:"@site/docs/Django/[DJ]GetStartedBuildCRM[2].md",sourceDirName:"Django",slug:"/Django/[DJ]GetStartedBuildCRM[2]",permalink:"/docs/Django/[DJ]GetStartedBuildCRM[2]",editUrl:"https://github.com/yehs1225/yehs1225.github.io/docs/Django/[DJ]GetStartedBuildCRM[2].md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"GetStarted - build CRM [1]",permalink:"/docs/Django/[DJ]GetStartedBuildCRM[1]"},next:{title:"Packages And Tools",permalink:"/docs/Django/[DJ]PackagesAndTools"}},p=[{value:"Model",id:"model",children:[{value:"Model Managers",id:"model-managers",children:[],level:3},{value:"Model Admin",id:"model-admin",children:[],level:3}],level:2},{value:"Forms",id:"forms",children:[{value:"Validate",id:"validate",children:[],level:4}],level:2},{value:"Image",id:"image",children:[{value:"In admin page",id:"in-admin-page",children:[],level:3},{value:"In html page",id:"in-html-page",children:[],level:3}],level:2},{value:"Message",id:"message",children:[],level:2},{value:"Custom Command",id:"custom-command",children:[],level:2},{value:"Improve TailwindCSS",id:"improve-tailwindcss",children:[],level:2},{value:"Import Data from .CSV",id:"import-data-from-csv",children:[],level:2}],d={toc:p};function c(e){var a=e.components,n=(0,l.Z)(e,i);return(0,r.kt)("wrapper",(0,t.Z)({},d,n,{components:a,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"getstarted---build-crm-1"},"GetStarted - build CRM ","[1]"),(0,r.kt)("h2",{id:"model"},"Model"),(0,r.kt)("h3",{id:"model-managers"},"Model Managers"),(0,r.kt)("p",null,"\u53ef\u4ee5\u5728models.py\u88e1\u9762\u5b9a\u7fa9\u529f\u80fd\u4f86manage model\uff0c\u50cf\u662f\u8a2d\u5b9a\u7279\u5b9a\u689d\u4ef6\u7684filter"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},'class LeadManager(models.Manager):\n    def get_queryset(self):\n        return super().get_queryset()\n    #the above is the default setting\n    def get_age_below_50(self):\n        return self.get_queryset().filter(age__lt=50)\n    \nclass Lead(models.Model):\n    first_name = models.CharField(max_length=20)\n    last_name = models.CharField(max_length=20)\n    age = models.IntegerField(default=0)\n    ...\n    email = models.EmailField()\n    \n    objects = LeadManager()\n    Lead.objects.get_age_below_50()\n    \n    def __str__(self):\n        return f"{self.first_name} {self.last_name}"\n')),(0,r.kt)("h3",{id:"model-admin"},"Model Admin"),(0,r.kt)("p",null,"\u53ef\u4ee5\u91dd\u5c0d\u7ba1\u7406\u8005\u4ecb\u9762\u589e\u6dfb\u60f3\u8981\u5448\u73fe\u7684\u529f\u80fd\uff0c\u5982\u4e0b"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"class LeadAdmin(admin.ModelAdmin):\n    list_display=['first_name','last_name','age','email']\n    list_display_links=['first_name']\n    list_editable=['last_name']\n    list_filter=['category']\n    search_fields=['first_name','last_name','email']\n\nadmin.site.register(Lead,LeadAdmin)\n")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"D:%5Cmodel-admin.png",alt:null})),(0,r.kt)("h2",{id:"forms"},"Forms"),(0,r.kt)("h4",{id:"validate"},"Validate"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"specific fields"),(0,r.kt)("li",{parentName:"ol"},"multiple fields")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},'import django.core.exceptions import ValidationError\n\nclass LeadModelForm(forms.ModelForm):\n    class Meta:\n        model = Lead\n        fields=(\n            \'first_name\',\n            \'last_name\',\n            \'age\',\n            \'agent\',\n            \'description\',\n            \'phone_number\',\n            \'email\',\n        )\n        \n        #specific fields\n        def clean_first_name(self):\n            #cleaned_data is a property of forms\n            data = self.cleaned_data["first_name"]\n            if data != "testuser"\n                raise ValidationError("Your name is not testuser")\n            return data\n        \n        #multiple fields \uff08no need to "return" again\uff09\n        def clean(self):\n            first_name = self.cleaned_data["first_name"]\n            last_name = self.cleaned_data["last_name"]\n            if first_name+last_name != "testUser One":\n                raise ValidationError("Your name is not testuser One")\n')),(0,r.kt)("h2",{id:"image"},"Image"),(0,r.kt)("h3",{id:"in-admin-page"},"In admin page"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Add new fields in the model"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},"profile_picture = models.ImageField(null=True,blank=True)\n"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"$pip install pillow")," \uff08",(0,r.kt)("inlineCode",{parentName:"p"},"$pip freeze > requirements.txt"),"\uff09")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"$python manage.py makemigrations"),"\u3001",(0,r.kt)("inlineCode",{parentName:"p"},"$python manage.py migrate")))),(0,r.kt)("p",null,"\u5982\u6b64\u4e00\u4f86\uff0c\u53ef\u5728admin\u9801\u9762\u589e\u6dfbimage file\uff0c\u800c\u9810\u8a2d\u7684\u5132\u5b58\u4f4d\u7f6e\u6703\u5728\u6839\u76ee\u9304\u3002\u5728\u90e8\u7f72\u6642\u6703\u9700\u8981\u5b58\u5728server\u7aef\uff0c\u4f46\u5728\u672c\u5730\u958b\u767c\u6642\u6211\u5011\u5148\u8a2d\u5b9a\u5b58\u5728image\u9019\u500b\u8cc7\u6599\u593e\u5167\u3002"),(0,r.kt)("p",null,"\u50cf\u8a2d\u5b9astatic\u5b58.js\u3001.css\u7b49\u6a94\u6848\u4e00\u6a23\uff08\u56e0\u6b64\u4e5f\u8981\u653e\u5165.gitignore\uff09\uff1a"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u5728settings.py \u52a0\u5165"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},"MEDIA_URL = '/media'\nMEDIA_ROOT = 'media_root'\n"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u5728urls.py\u7684settings.DEBUG\u52a0\u5165"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},"if settings.DEBUG:\n    ...\n    urlpatterns += static('settins.MEDIA_URL',document_root=settings.MEDIA_ROOT)\n")))),(0,r.kt)("p",null,"\u53ef\u5728",(0,r.kt)("inlineCode",{parentName:"p"},"models.ImageField"),"\u7684\u53c3\u6578\u52a0\u5165 ",(0,r.kt)("inlineCode",{parentName:"p"},"upload_to"),"\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"profile_picture = models.ImageField(null=True,blank=True,upload_to='profile_pictures')\n#\u5176\u4e2dprofile_pictures\u4ee3\u8868\u6703\u5728images/\u65b0\u589e\u4e00\u500b\u8cc7\u6599\u593e\u5132\u5b58\n")),(0,r.kt)("h3",{id:"in-html-page"},"In html page"),(0,r.kt)("p",null,"\u5728\u4e0a\u9762\u7684\u8a2d\u5b9a\u5728html\u4e26\u4e0d\u7ba1\u7528\uff0c\u4e5f\u5c31\u662f\u8aaa\u5982\u679c\u6211\u5011\u662f\u5f9elead_update.html\u9019\u500b\u9801\u9762\u53bb\u4e0a\u50b3\u7167\u7247\u6642\uff0c\u4e26\u4e0d\u80fd\u88ab\u8a18\u9304\u5230\uff0c\u6211\u5011\u9084\u9700\u8981\u53bb\u6539\u52d5html\u88e1\u7684form tag"),(0,r.kt)("p",null,"\u52a0\u5165form\u7684\u5c6c\u6027",(0,r.kt)("inlineCode",{parentName:"p"},"enctype"),"\uff0c\u4e26\u8a2d\u5b9a\u6210",(0,r.kt)("inlineCode",{parentName:"p"},'"multipart/form-data"'),"\u4ee3\u8868\u5141\u8a31\u6b64\u7db2\u9801\u63a5\u6536\u5716\u7247\u7b49\u6a94\u6848\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-html"},'<form method="post" enctype="multipart/form-data">\n')),(0,r.kt)("h2",{id:"message"},"Message"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://docs.djangoproject.com/en/4.0/ref/contrib/messages/"},"The messages framework | Django documentation | Django (djangoproject.com)")),(0,r.kt)("p",null,"\u53ef\u7528\u5728\u6210\u529f\u586b\u5beb\u8868\u55ae\u5f8c\u8df3\u51fa\u901a\u77e5\uff0c\u4f8b\u5982\u6211\u5011\u52a0\u5728\u6210\u529f\u5275\u5efaLead\u4e4b\u5f8c"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},'#Leads/views.py\nclass LeadCreateView(OrganizorAndLoginRequiredMixin,CreateView):\n    ...\n    def form_valid(self,form):\n        lead = form.save(commit=False)\n        ...\n        messages.success(self.request,"Successfully create!")\n        return super(LeadCreateView,self).form_valid(form)\n')),(0,r.kt)("p",null,"\u6216\u662fupdate view"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},'class LeadUpdateView(OrganizorAndLoginRequiredMixin,UpdateView):\n    template_name = "leads/lead_update.html"\n    ...\n\n    def form_valid(self,form):\n        form.save()\n        messages.info(self.request,"You have successfully updated this lead!")\n        return super(LeadUpdateView,self).form_valid(form)\n')),(0,r.kt)("p",null,"\u63a5\u8005\u5728base.html\u4e2d\u52a0\u5165\uff08\u57fa\u672c\u6a21\u677f\uff09"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-django"},'{% if messages %}\n<ul class="messages">\n    {% for message in messages %}\n    <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>\n    {% endfor %}\n</ul>\n{% endif %}\n')),(0,r.kt)("p",null,"\u4e5f\u53ef\u4ee5\u505a\u9ede\u4fee\u6539\uff0c\u628aclass\u6539\u6210\u9019\u6a23"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-django"},"class=\"{% if message.tags == 'success' %}bg-green-500 text-white{% endif %}\"\n")),(0,r.kt)("p",null,"\u5728\u672c\u5c08\u6848\u4e2d\uff0c\u6211\u5011\u5c07message\u7368\u7acb\u653e\u5230message.html\uff0c\u518d\u5728base.html\u5f15\u7528"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-django"},"{% if messages %}\n    {% for message in messages %}\n        <div class=\"p-4 border-l-4\n        {% if message.tags == 'success' %}\n        bg-green-50 border-green-400\n        {% elif message.tags == 'info' %}\n        bg-blue-50 border-blue-400\n        {% elif message.tags == 'warning' %}\n        bg-yellow-50 border-yellow-400\n        {% else %}\n        bg-red-50 border-red-400\n        {% endif %}\n        \">\n        \n        <p class=\"text-sm\n        {% if message.tags == 'success' %}\n        text-green-700\n        {% elif message.tags == 'info' %}\n        text-blue-700\n        {% elif message.tags == 'warning' %}\n        text-yellow-700\n        {% else %}\n        text-red-700\n        {% endif %}\n        \">\n            {{ message }}\n        </p>\n        </div>\n    {% endfor %}\n{% endif %}\n")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"\u56e0\u70ba\u6015",(0,r.kt)("inlineCode",{parentName:"strong"},"if"),"\u3001",(0,r.kt)("inlineCode",{parentName:"strong"},"else"),"\u5224\u65b7\u5f0f\u6703\u9020\u6210tailwind\u6c92\u6709\u63a1\u7528\u5230\uff0c\u6240\u4ee5\u7279\u5225\u653e\u5165safelist\uff08\u4e0b\u9762Improve TailwindCSS\u6709\uff09")),(0,r.kt)("h2",{id:"custom-command"},"Custom Command"),(0,r.kt)("p",null,"\u6211\u5011\u5e38\u7528\u7684command"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"$python manage.py runserver"),"\u3001",(0,r.kt)("inlineCode",{parentName:"p"},"$python manage.py migrate"),"\u7b49\u7b49"),(0,r.kt)("p",null,"\u6211\u5011\u53ef\u4ee5\u81ea\u5df1\u52a0\u5165\u60f3\u8981\u7684command\uff0c\u9019\u88e1\u4ee5\u52a0\u5165",(0,r.kt)("inlineCode",{parentName:"p"},"$python manage.py create_lead"),"\u8aaa\u660e"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u5728app leads\u4e2d\u65b0\u589e\u8cc7\u6599\u593emanagement/commands/")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u5728\u88cf\u982d\u65b0\u589ecreate_lead.py")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u5728create_lead.py\u7de8\u5beb"),(0,r.kt)("p",{parentName:"li"},"import :"),(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"from django.core.management.base import BaseCommand")),(0,r.kt)("p",{parentName:"li"},"Method : "),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"handle(self, *args,**options)"),":\u57fa\u790e\u7684\u65b9\u6cd5"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"add_arguments(self,parser)")," : \u63a5\u6536\u6307\u4ee4\u4e2d\u7684args\uff0c\u4f8b\u5982",(0,r.kt)("inlineCode",{parentName:"li"},"$python manage.py create_lead John"),"\u7576\u4e2d\u7684John")),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},"from django.core.management.base import BaseCommand\n\nclass Command(BaseCommand):\n\n    def add_arguments(self, parser):\n        parser.add_argument('first_name',type=str)\n\n    def handle(self, *args,**options):\n        print(options['first_name'])\n")),(0,r.kt)("p",{parentName:"li"},"\u5982\u679c\u57f7\u884c",(0,r.kt)("inlineCode",{parentName:"p"},"$python manage.py create_lead John"),"\u5c31\u6703\u5f97\u5230John"))),(0,r.kt)("h2",{id:"improve-tailwindcss"},"Improve TailwindCSS"),(0,r.kt)("p",null,"\u539f\u5148\u662f\u76f4\u63a5\u7528\u6574\u500btailwind\uff0c\u4f46\u662f\u6709\u5f88\u591a\u5176\u5be6\u6211\u5011\u5b8c\u5168\u7528\u4e0d\u5230!\u4e00\u500b\u539f\u59cb\u7684\u505a\u6cd5\u662f\u5c07\u6240\u6709.html\u4e2d\u6709\u7528\u5230\u7684\u653e\u5728\u4e00\u500b\u6a94\u6848\u88e1\uff0c\u7136\u5f8c\u5f15\u7528\u3002\u4f46\u6211\u5011\u53ef\u4ee5\u4f7f\u7528\u7b2c\u4e09\u65b9\u5957\u4ef6",(0,r.kt)("a",{parentName:"p",href:"https://django-tailwind.readthedocs.io/en/latest/installation.html"},"Django-Tailwind 2.0.0 documentation"),"\u3002\u57fa\u672c\u4e0a\uff0c\u6309\u7167\u6307\u793a\u8a2d\u5b9a\u5c31\u53ef\u4ee5\u3002\u5e7e\u9805\u91cd\u9ede\u5982\u4e0b"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"$python manage.py tailwind build"),"\u9700\u8981\u5728\u6bcf\u6b21\u6709\u6539\u52d5css\u5f8c\u57f7\u884c")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u5728tailwind.config.js\u4e2d\u8a2d\u5b9a\u8981\u88ab\u5305\u542b\u7684.html"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-js"},"module.exports = {\n    content: [\n        // Templates within theme app (e.g. base.html)\n        '../templates/**/*.html',\n        // Templates in other apps\n        '../../templates/**/*.html',\n        // Ignore files in node_modules \n        '!../../**/node_modules',\n        // Include JavaScript files that might contain Tailwind CSS classes      \n        '../../**/*.js',\n        // Include Python files that might contain Tailwind CSS classes\n        '../../**/*.py'\n    ],\n    ...\n}\n"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"\u82e5\u6709\u4e00\u5b9a\u8981\u88ab\u5305\u542b\u7684\u53ef\u653e\u5728safelist\u88e1\u9762\uff08\u56e0\u70ba\u6709\u6642\u5019\u7528",(0,r.kt)("inlineCode",{parentName:"p"},"if"),"\u3001",(0,r.kt)("inlineCode",{parentName:"p"},"else"),"\u5224\u65b7\u5f0f\uff0c\u6015\u6703\u6c92\u88ab\u5305\u542b\u9032\u4f86\uff09"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-js"},"module.exports = {\n    content: [\n        // Templates within theme app (e.g. base.html)\n        '../templates/**/*.html',\n        // Templates in other apps\n        '../../templates/**/*.html',\n        // Ignore files in node_modules \n        '!../../**/node_modules',\n        // Include JavaScript files that might contain Tailwind CSS classes      \n        '../../**/*.js',\n        // Include Python files that might contain Tailwind CSS classes\n        '../../**/*.py'\n    ],\n    safelist:[\n        ....//\u5fc5\u9808\u88ab\u5305\u542b\u7684css\u6a23\u5f0f\n    ]\n    ...\n}\n")))),(0,r.kt)("h2",{id:"import-data-from-csv"},"Import Data from .CSV"),(0,r.kt)("p",null,"\u9019\u88e1\u6211\u5011\u60f3\u8981\u81ea\u52d5\u52a0\u5165leads"),(0,r.kt)("p",null,"\u5148\u5275\u7acb\u4e00\u500bleads.csv\uff0c\u5305\u542b\u60f3\u8981\u7684\u6b04\u4f4dfirst_name, last_name, age, email"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"first_name,last_name,age,email\njoe,soap,35,joesoap@test.com\nbob,rice,37,bob@test.com\nmary,meat,42,mary@test.com\nluke,drink,25,luke@test.com\njohn,spoon,15,john@test.com\nmax,fork,39,max@test.com\nmark,napkin,14,mark@test.com\nbilly,bottle,27,billy@test.com\n")),(0,r.kt)("p",null,"\u63a5\u8005\u4fee\u6539Custom command \uff08\u4e4b\u524d\u6709\u5beb\u904e\u518dleads/management/commands\u4e2d\u6709\u500bcreate_leads.py\uff09"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u8b80\u53d6\u6a94\u6848\u540d\u7a31\u3001organizor_email \uff08\u56e0\u70baorganization\u6b04\u4f4d\u4e0d\u53ef\u7a7a\u767d\uff0c\u6240\u4ee5\u8981\u7528\u4f86\u627e\u662f\u54ea\u500borganizor\uff09\u4e26\u6307\u5b9a\u7d66\u8b8a\u6578\u3002"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},"class Command(BaseCommand):\n\n    def add_arguments(self, parser):\n        parser.add_argument('file_name',type=str)\n        parser.add_argument('organizor_email',type=str)\n        \n    def handle(self, *args,**options):\n        file_name=options['file_name']\n        organizor_email=options['organizor_email']\n"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u5f15\u5165model\u3001\u5c07csv\u8f49\u70baDictReader\u7684python package"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},"from csv import DictReader\nfrom leads.models import Lead,UserProfile\n"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u5229\u7528model UserProfile\u627e\u5230user\u5f8c\u5b58\u5728",(0,r.kt)("inlineCode",{parentName:"p"},"organization"),"\u8b8a\u6578\u7576\u4e2d"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},"organization = UserProfile.objects.get(user__email=organizor_email)\n"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"\u8b80\u53d6csv\u5f8c\uff0c\u5728Lead\u4e2d\u5efa\u7acb\u8cc7\u6599"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},"with open(file_name,'r') as read_obj:\n            csv_reader = DictReader(read_obj)\n            for row in csv_reader:\n                first_name = row['first_name']\n                last_name = row['last_name']\n                age = row['age']\n                email = row['email']\n\n                #TODO create the lead\n                Lead.objects.create(\n                    organization=organization,\n                    first_name=first_name,\n                    last_name=last_name,\n                    age=age,\n                    email=email,\n                )\n")))),(0,r.kt)("p",null,"\u5b8c\u6574\u7248"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"from django.core.management.base import BaseCommand\nfrom csv import DictReader\nfrom leads.models import Lead,UserProfile\n\nclass Command(BaseCommand):\n\n    def add_arguments(self, parser):\n        parser.add_argument('file_name',type=str)\n        parser.add_argument('organizor_email',type=str)\n\n    def handle(self, *args,**options):\n        file_name=options['file_name']\n        organizor_email=options['organizor_email']\n        organization = UserProfile.objects.get(user__email=organizor_email)\n\n        with open(file_name,'r') as read_obj:\n            csv_reader = DictReader(read_obj)\n            for row in csv_reader:\n                first_name = row['first_name']\n                last_name = row['last_name']\n                age = row['age']\n                email = row['email']\n\n                #TODO create the lead\n                Lead.objects.create(\n                    organization=organization,\n                    first_name=first_name,\n                    last_name=last_name,\n                    age=age,\n                    email=email,\n                )\n\n")))}c.isMDXComponent=!0}}]);